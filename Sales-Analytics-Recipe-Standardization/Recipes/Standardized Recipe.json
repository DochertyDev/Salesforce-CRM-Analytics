{
    "version": "64.0",
    "nodes": {
        "Extract_Task_1": {
            "action": "load",
            "parameters": {
                "dataset": {
                    "connectionName": "SFDC_LOCAL",
                    "sourceObjectName": "Task",
                    "type": "connectedDataset"
                },
                "fields": [
                    "Id",
                    "CallDurationInSeconds",
                    "CallDisposition",
                    "CallType",
                    "OwnerId",
                    "Status",
                    "Priority",
                    "IsClosed",
                    "TaskSubtype",
                    "CreatedDate",
                    "ActivityDate",
                    "LastModifiedDate",
                    "Subject",
                    "WhatId",
                    "AccountId"
                ],
                "sampleDetails": {
                    "sortBy": [],
                    "type": "TopN"
                }
            },
            "sources": []
        },
        "Extract_Task_2": {
            "action": "schema",
            "parameters": {
                "fields": [
                    {
                        "name": "CreatedDate",
                        "newProperties": {
                            "label": "CreatedDate",
                            "name": "CreatedDate"
                        }
                    }
                ]
            },
            "sources": [
                "Extract_Task_1"
            ]
        },
        "Extract_Task": {
            "action": "schema",
            "parameters": {
                "fields": [
                    {
                        "name": "ActivityDate",
                        "newProperties": {
                            "label": "ActivityDate",
                            "name": "ActivityDate"
                        }
                    }
                ]
            },
            "sources": [
                "Extract_Task_2"
            ]
        },
        "Add_Fields_To_Task_1": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "TaskSubtype",
                        "label": "EventSubtype",
                        "name": "EventSubtype",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Extract_Task"
            ]
        },
        "Add_Fields_To_Task": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "0",
                        "formulaExpression": "0",
                        "label": "DurationInMinutes",
                        "name": "DurationInMinutes",
                        "precision": 8,
                        "scale": 0,
                        "type": "NUMBER"
                    }
                ]
            },
            "sources": [
                "Add_Fields_To_Task_1"
            ]
        },
        "Extract_Event_1": {
            "action": "load",
            "parameters": {
                "dataset": {
                    "connectionName": "SFDC_LOCAL",
                    "sourceObjectName": "Event",
                    "type": "connectedDataset"
                },
                "fields": [
                    "OwnerId",
                    "CreatedDate",
                    "LastModifiedDate",
                    "ActivityDate",
                    "Subject",
                    "DurationInMinutes",
                    "EventSubtype",
                    "WhatId",
                    "AccountId"
                ],
                "sampleDetails": {
                    "sortBy": [],
                    "type": "TopN"
                }
            },
            "sources": []
        },
        "Extract_Event_2": {
            "action": "schema",
            "parameters": {
                "fields": [
                    {
                        "name": "CreatedDate",
                        "newProperties": {
                            "label": "CreatedDate",
                            "name": "CreatedDate"
                        }
                    }
                ]
            },
            "sources": [
                "Extract_Event_1"
            ]
        },
        "Extract_Event": {
            "action": "schema",
            "parameters": {
                "fields": [
                    {
                        "name": "ActivityDate",
                        "newProperties": {
                            "label": "ActivityDate",
                            "name": "ActivityDate"
                        }
                    }
                ]
            },
            "sources": [
                "Extract_Event_2"
            ]
        },
        "Add_Fields_To_Event_1": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "'Event'",
                        "label": "CallDisposition",
                        "name": "CallDisposition",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Extract_Event"
            ]
        },
        "Add_Fields_To_Event_2": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "'Event'",
                        "label": "CallType",
                        "name": "CallType",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Add_Fields_To_Event_1"
            ]
        },
        "Add_Fields_To_Event_3": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "'Event'",
                        "label": "Status",
                        "name": "Status",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Add_Fields_To_Event_2"
            ]
        },
        "Add_Fields_To_Event_4": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "'Event'",
                        "label": "Priority",
                        "name": "Priority",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Add_Fields_To_Event_3"
            ]
        },
        "Add_Fields_To_Event_5": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "EventSubtype",
                        "label": "TaskSubtype",
                        "name": "TaskSubtype",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Add_Fields_To_Event_4"
            ]
        },
        "Add_Fields_To_Event_6": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "0",
                        "formulaExpression": "0",
                        "label": "CallDurationInSeconds",
                        "name": "CallDurationInSeconds",
                        "precision": 8,
                        "scale": 0,
                        "type": "NUMBER"
                    }
                ]
            },
            "sources": [
                "Add_Fields_To_Event_5"
            ]
        },
        "Add_Fields_To_Event": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "",
                        "formulaExpression": "case when dateDiff(to_timestamp(ActivityDate), now()) >= 0 then 'true' else 'false' end",
                        "label": "IsClosed",
                        "name": "IsClosed",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Add_Fields_To_Event_6"
            ]
        },
        "Append_TaskEvent": {
            "action": "appendV2",
            "parameters": {
                "allowImplicitDisjointSchema": true,
                "fieldMappings": []
            },
            "sources": [
                "Add_Fields_To_Task",
                "Add_Fields_To_Event"
            ]
        },
        "Extract_User_1": {
            "action": "load",
            "parameters": {
                "dataset": {
                    "connectionName": "SFDC_LOCAL",
                    "sourceObjectName": "User",
                    "type": "connectedDataset"
                },
                "fields": [
                    "Id",
                    "Username",
                    "Name",
                    "FirstName",
                    "LastName",
                    "UserRoleId",
                    "UserType",
                    "IsActive",
                    "FullPhotoUrl",
                    "SmallPhotoUrl",
                    "ManagerId"
                ],
                "sampleDetails": {
                    "sortBy": [],
                    "type": "TopN"
                }
            },
            "sources": []
        },
        "Extract_User": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "coalesce(\"ManagerId\",null,'N/A')",
                        "label": "ManagerId",
                        "name": "ManagerId_replace",
                        "type": "TEXT"
                    }
                ]
            },
            "schema": {
                "fields": [
                    {
                        "name": "ManagerId_replace",
                        "newProperties": {
                            "name": "ManagerId"
                        }
                    }
                ],
                "slice": {
                    "fields": [
                        "ManagerId"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "DROP"
                }
            },
            "sources": [
                "Extract_User_1"
            ]
        },
        "Filter_User": {
            "action": "filter",
            "parameters": {
                "filterExpressions": [
                    {
                        "field": "UserType",
                        "operands": [
                            "Standard",
                            "PowerPartner"
                        ],
                        "operator": "EQUAL"
                    }
                ]
            },
            "sources": [
                "Extract_User"
            ]
        },
        "Compute_Unique_Name": {
            "action": "computeRelative",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "",
                        "formulaExpression": "lead(Id)",
                        "label": "isDuplicate",
                        "name": "isDuplicate",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ],
                "orderBy": [
                    {
                        "direction": "ASC",
                        "fieldName": "Id"
                    }
                ],
                "partitionBy": [
                    "Name"
                ]
            },
            "sources": [
                "Filter_User"
            ]
        },
        "Compute_Manager_Unique": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "case when isDuplicate IS NULL then Name else Name || ' (' || Username || ')' end",
                        "label": "UniqueUserName",
                        "name": "UniqueUserName",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Compute_Unique_Name"
            ]
        },
        "Join_User_Manager": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "ManagerId"
                ],
                "rightKeys": [
                    "Id"
                ],
                "rightQualifier": "UserManager"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "Username",
                        "LastName",
                        "FirstName",
                        "Name",
                        "IsActive",
                        "UserRoleId",
                        "UserType",
                        "ManagerId",
                        "FullPhotoUrl",
                        "SmallPhotoUrl",
                        "isDuplicate",
                        "UniqueUserName",
                        "UserManager.Name",
                        "UserManager.Username",
                        "UserManager.FullPhotoUrl",
                        "UserManager.SmallPhotoUrl",
                        "UserManager.UserRoleId",
                        "UserManager.Id",
                        "UserManager.UniqueUserName"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Compute_Manager_Unique",
                "Compute_Manager_Unique"
            ]
        },
        "Flatten_UserManager": {
            "action": "flatten",
            "parameters": {
                "includeSelfId": true,
                "multiField": {
                    "label": "UserManagerNames",
                    "name": "UserManagerNames"
                },
                "parentField": "UserManager.UniqueUserName",
                "pathField": {
                    "label": "ManagerNamesPath",
                    "name": "ManagerNamesPath"
                },
                "selfField": "UniqueUserName"
            },
            "sources": [
                "Join_User_Manager"
            ]
        },
        "Extract_UserRole": {
            "action": "load",
            "parameters": {
                "dataset": {
                    "connectionName": "SFDC_LOCAL",
                    "sourceObjectName": "UserRole",
                    "type": "connectedDataset"
                },
                "fields": [
                    "Id",
                    "Name",
                    "DeveloperName",
                    "ParentRoleId",
                    "LastModifiedDate",
                    "LastModifiedById",
                    "SystemModstamp"
                ],
                "sampleDetails": {
                    "sortBy": [],
                    "type": "TopN"
                }
            },
            "sources": []
        },
        "Flatten_UserRole": {
            "action": "flatten",
            "parameters": {
                "includeSelfId": false,
                "multiField": {
                    "label": "Roles",
                    "name": "Roles"
                },
                "parentField": "ParentRoleId",
                "pathField": {
                    "label": "RolePath",
                    "name": "RolePath"
                },
                "selfField": "Id"
            },
            "sources": [
                "Extract_UserRole"
            ]
        },
        "Augment_ParentName": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "ParentRoleId"
                ],
                "rightKeys": [
                    "Id"
                ],
                "rightQualifier": "ParentRole"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "Name",
                        "ParentRoleId",
                        "LastModifiedDate",
                        "LastModifiedById",
                        "SystemModstamp",
                        "DeveloperName",
                        "Roles",
                        "RolePath",
                        "ParentRole.Name",
                        "ParentRole.DeveloperName",
                        "ParentRole.ParentRoleId"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Flatten_UserRole",
                "Extract_UserRole"
            ]
        },
        "Flatten_ParentName": {
            "action": "flatten",
            "parameters": {
                "includeSelfId": true,
                "multiField": {
                    "label": "RoleNames",
                    "name": "RoleNames"
                },
                "parentField": "ParentRole.DeveloperName",
                "pathField": {
                    "label": "RoleNamesPath",
                    "name": "RoleNamesPath"
                },
                "selfField": "DeveloperName"
            },
            "sources": [
                "Augment_ParentName"
            ]
        },
        "Flatten_Hierarchy_Grouping": {
            "action": "flatten",
            "parameters": {
                "includeSelfId": true,
                "multiField": {
                    "label": "Hierarchy_RoleNames",
                    "name": "Hierarchy_RoleNames"
                },
                "parentField": "ParentRole.DeveloperName",
                "pathField": {
                    "label": "Hierarchy_RoleNamesPath",
                    "name": "Hierarchy_RoleNamesPath"
                },
                "selfField": "DeveloperName"
            },
            "sources": [
                "Flatten_ParentName"
            ]
        },
        "User_with_Roles": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "UserRoleId"
                ],
                "rightKeys": [
                    "Id"
                ],
                "rightQualifier": "Role"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "Username",
                        "LastName",
                        "FirstName",
                        "Name",
                        "IsActive",
                        "UserRoleId",
                        "UserType",
                        "ManagerId",
                        "FullPhotoUrl",
                        "SmallPhotoUrl",
                        "isDuplicate",
                        "UniqueUserName",
                        "UserManager.Id",
                        "UserManager.Username",
                        "UserManager.Name",
                        "UserManager.UserRoleId",
                        "UserManager.FullPhotoUrl",
                        "UserManager.SmallPhotoUrl",
                        "UserManager.UniqueUserName",
                        "UserManagerNames",
                        "ManagerNamesPath",
                        "Role.Name",
                        "Role.DeveloperName",
                        "Role.Roles",
                        "Role.RolePath",
                        "Role.ParentRoleId",
                        "Role.ParentRole.Name",
                        "Role.ParentRole.DeveloperName",
                        "Role.RoleNames",
                        "Role.Hierarchy_RoleNames",
                        "Role.RoleNamesPath"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Flatten_UserManager",
                "Flatten_Hierarchy_Grouping"
            ]
        },
        "Join_ActivityOwner": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "OwnerId"
                ],
                "rightKeys": [
                    "Id"
                ],
                "rightQualifier": "Owner"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "WhatId",
                        "Subject",
                        "ActivityDate",
                        "Status",
                        "Priority",
                        "OwnerId",
                        "AccountId",
                        "IsClosed",
                        "CreatedDate",
                        "LastModifiedDate",
                        "CallDurationInSeconds",
                        "CallType",
                        "CallDisposition",
                        "TaskSubtype",
                        "EventSubtype",
                        "DurationInMinutes",
                        "Owner.Name",
                        "Owner.Username",
                        "Owner.UserRoleId",
                        "Owner.UserManager.Name",
                        "Owner.UserManagerNames",
                        "Owner.UniqueUserName",
                        "Owner.UserManager.UniqueUserName",
                        "Owner.FullPhotoUrl",
                        "Owner.SmallPhotoUrl",
                        "Owner.Role.Name",
                        "Owner.Role.DeveloperName",
                        "Owner.Role.Roles",
                        "Owner.Role.RolePath",
                        "Owner.Role.ParentRoleId",
                        "Owner.Role.ParentRole.Name",
                        "Owner.Role.ParentRole.DeveloperName",
                        "Owner.Role.RoleNames",
                        "Owner.Role.RoleNamesPath",
                        "Owner.Role.Hierarchy_RoleNames"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Append_TaskEvent",
                "User_with_Roles"
            ]
        },
        "Extract_OpportunityLineItem": {
            "action": "load",
            "parameters": {
                "dataset": {
                    "connectionName": "SFDC_LOCAL",
                    "sourceObjectName": "OpportunityLineItem",
                    "type": "connectedDataset"
                },
                "fields": [
                    "OpportunityId",
                    "ProductCode",
                    "ListPrice",
                    "Quantity",
                    "TotalPrice",
                    "PricebookEntryId",
                    "ServiceDate"
                ],
                "sampleDetails": {
                    "sortBy": [],
                    "type": "TopN"
                }
            },
            "sources": []
        },
        "Extract_Opportunity_1": {
            "action": "load",
            "parameters": {
                "dataset": {
                    "connectionName": "SFDC_LOCAL",
                    "sourceObjectName": "Opportunity",
                    "type": "connectedDataset"
                },
                "fields": [
                    "Id",
                    "AccountId",
                    "OwnerId",
                    "Name",
                    "StageName",
                    "LeadSource",
                    "IsWon",
                    "Type",
                    "IsClosed",
                    "ForecastCategory",
                    "ForecastCategoryName",
                    "CreatedDate",
                    "CloseDate",
                    "Amount",
                    "CreatedById",
                    "LastModifiedDate",
                    "LastActivityDate",
                    "HasOpportunityLineItem"
                ],
                "sampleDetails": {
                    "sortBy": [],
                    "type": "TopN"
                }
            },
            "sources": []
        },
        "Extract_Opportunity_2": {
            "action": "schema",
            "parameters": {
                "fields": [
                    {
                        "name": "CreatedDate",
                        "newProperties": {
                            "label": "CreatedDate",
                            "name": "CreatedDate"
                        }
                    }
                ]
            },
            "sources": [
                "Extract_Opportunity_1"
            ]
        },
        "Extract_Opportunity": {
            "action": "schema",
            "parameters": {
                "fields": [
                    {
                        "name": "CloseDate",
                        "newProperties": {
                            "label": "CloseDate",
                            "name": "CloseDate"
                        }
                    }
                ]
            },
            "sources": [
                "Extract_Opportunity_2"
            ]
        },
        "Add_Fields_To_Opportunity_1": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "case when LastActivityDate IS NULL then dateDiff(to_timestamp(to_unix_timestamp(LastModifiedDate)), now()) when LastModifiedDate > LastActivityDate then dateDiff(to_timestamp(to_unix_timestamp(LastModifiedDate)), now()) else dateDiff(to_timestamp(to_unix_timestamp(LastActivityDate)), now()) end",
                        "label": "Days Since Last Activity",
                        "name": "DaysSinceLastActivity",
                        "precision": 8,
                        "scale": 0,
                        "type": "NUMBER"
                    }
                ]
            },
            "sources": [
                "Extract_Opportunity"
            ]
        },
        "Add_Fields_To_Opportunity_2": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "",
                        "formulaExpression": "case when IsClosed = 'false' then dateDiff(to_timestamp(CreatedDate), now()) else dateDiff(to_timestamp(CreatedDate), to_timestamp(CloseDate)) end",
                        "label": "Opportunity Age",
                        "name": "OpportunityAge",
                        "precision": 8,
                        "scale": 0,
                        "type": "NUMBER"
                    }
                ]
            },
            "sources": [
                "Add_Fields_To_Opportunity_1"
            ]
        },
        "Add_Fields_To_Opportunity_3": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "",
                        "formulaExpression": "case when IsClosed = 'false' AND (to_timestamp(CloseDate) < now()) then dateDiff(to_timestamp(CloseDate), now()) else 0 end",
                        "label": "Days Past Due",
                        "name": "DaysPastDue",
                        "precision": 8,
                        "scale": 0,
                        "type": "NUMBER"
                    }
                ]
            },
            "sources": [
                "Add_Fields_To_Opportunity_2"
            ]
        },
        "Add_Fields_To_Opportunity": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "",
                        "formulaExpression": "case when IsClosed = 'false' AND (to_timestamp(CloseDate) < now()) then 'true' else 'false' end",
                        "label": "Past Due",
                        "name": "IsPastDue",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Add_Fields_To_Opportunity_3"
            ]
        },
        "Add_Neglected_To_Opportunity": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "case when DaysSinceLastActivity >= 60 AND IsClosed = 'false' then 'true' else 'false' end",
                        "label": "Neglected",
                        "name": "Neglected",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Add_Fields_To_Opportunity"
            ]
        },
        "Opportunities_No_Products": {
            "action": "filter",
            "parameters": {
                "filterExpressions": [
                    {
                        "field": "HasOpportunityLineItem",
                        "operands": [
                            "false"
                        ],
                        "operator": "EQUAL"
                    }
                ]
            },
            "sources": [
                "Add_Neglected_To_Opportunity"
            ]
        },
        "Compute_Opportunities_No_Products_1": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "Id",
                        "label": "OpportunityId",
                        "name": "OpportunityId",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Opportunities_No_Products"
            ]
        },
        "Compute_Opportunities_No_Products_2": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "'N/A'",
                        "label": "ProductCode",
                        "name": "ProductCode",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Compute_Opportunities_No_Products_1"
            ]
        },
        "Compute_Opportunities_No_Products_3": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "Amount",
                        "label": "ListPrice",
                        "name": "ListPrice",
                        "precision": 18,
                        "scale": 2,
                        "type": "NUMBER"
                    }
                ]
            },
            "sources": [
                "Compute_Opportunities_No_Products_2"
            ]
        },
        "Compute_Opportunities_No_Products_4": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "1",
                        "label": "Quantity",
                        "name": "Quantity",
                        "precision": 18,
                        "scale": 2,
                        "type": "NUMBER"
                    }
                ]
            },
            "sources": [
                "Compute_Opportunities_No_Products_3"
            ]
        },
        "Compute_Opportunities_No_Products_5": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "Amount",
                        "label": "Total Price",
                        "name": "TotalPrice",
                        "precision": 18,
                        "scale": 2,
                        "type": "NUMBER"
                    }
                ]
            },
            "sources": [
                "Compute_Opportunities_No_Products_4"
            ]
        },
        "Compute_Opportunities_No_Products_6": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "Id",
                        "label": "PricebookEntryId",
                        "name": "PricebookEntryId",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Compute_Opportunities_No_Products_5"
            ]
        },
        "Compute_Opportunities_No_Products_7": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "",
                        "format": "yyyy-MM-dd",
                        "formulaExpression": "to_timestamp(CloseDate)",
                        "label": "ServiceDate",
                        "name": "ServiceDate",
                        "type": "DATETIME"
                    }
                ]
            },
            "sources": [
                "Compute_Opportunities_No_Products_6"
            ]
        },
        "Compute_Opportunities_No_Products": {
            "action": "schema",
            "parameters": {
                "fields": [],
                "slice": {
                    "fields": [
                        "OpportunityId",
                        "ProductCode",
                        "ListPrice",
                        "Quantity",
                        "TotalPrice",
                        "PricebookEntryId",
                        "ServiceDate"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Compute_Opportunities_No_Products_7"
            ]
        },
        "Compute_Opportunities_No_Products_Id": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "OpportunityId",
                        "label": "Id",
                        "name": "Id",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Compute_Opportunities_No_Products"
            ]
        },
        "Append_LineItems": {
            "action": "appendV2",
            "parameters": {
                "allowImplicitDisjointSchema": true,
                "fieldMappings": []
            },
            "sources": [
                "Extract_OpportunityLineItem",
                "Compute_Opportunities_No_Products_Id"
            ]
        },
        "Discount_Field_1": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "1 - ((TotalPrice) / (ListPrice * Quantity))",
                        "label": "Discount_Percent",
                        "name": "Discount_Percent",
                        "precision": 7,
                        "scale": 6,
                        "type": "NUMBER"
                    }
                ]
            },
            "sources": [
                "Append_LineItems"
            ]
        },
        "Discount_Field": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "ListPrice * Quantity",
                        "label": "Total_ListPrice",
                        "name": "Total_ListPrice",
                        "precision": 7,
                        "scale": 6,
                        "type": "NUMBER"
                    }
                ]
            },
            "sources": [
                "Discount_Field_1"
            ]
        },
        "Extract_PricebookEntry": {
            "action": "load",
            "parameters": {
                "dataset": {
                    "connectionName": "SFDC_LOCAL",
                    "sourceObjectName": "PricebookEntry",
                    "type": "connectedDataset"
                },
                "fields": [
                    "Id",
                    "Product2Id"
                ],
                "sampleDetails": {
                    "sortBy": [],
                    "type": "TopN"
                }
            },
            "sources": []
        },
        "Join_OpportunityLineItemPricebookEntry": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "PricebookEntryId"
                ],
                "rightKeys": [
                    "Id"
                ],
                "rightQualifier": "Pricebook"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "OpportunityId",
                        "PricebookEntryId",
                        "ProductCode",
                        "Quantity",
                        "TotalPrice",
                        "ListPrice",
                        "ServiceDate",
                        "Id",
                        "Discount_Percent",
                        "Total_ListPrice",
                        "Pricebook.Product2Id"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Discount_Field",
                "Extract_PricebookEntry"
            ]
        },
        "Extract_Product": {
            "action": "load",
            "parameters": {
                "dataset": {
                    "connectionName": "SFDC_LOCAL",
                    "sourceObjectName": "Product2",
                    "type": "connectedDataset"
                },
                "fields": [
                    "Id",
                    "ProductCode",
                    "Name",
                    "Family"
                ],
                "sampleDetails": {
                    "sortBy": [],
                    "type": "TopN"
                }
            },
            "sources": []
        },
        "Join_OpportunityLineItemPricebookEntryProduct": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "Pricebook.Product2Id"
                ],
                "rightKeys": [
                    "Id"
                ],
                "rightQualifier": "Product"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "OpportunityId",
                        "PricebookEntryId",
                        "ProductCode",
                        "Quantity",
                        "TotalPrice",
                        "ListPrice",
                        "ServiceDate",
                        "Id",
                        "Discount_Percent",
                        "Total_ListPrice",
                        "Pricebook.Product2Id",
                        "Product.ProductCode",
                        "Product.Name",
                        "Product.Family"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Join_OpportunityLineItemPricebookEntry",
                "Extract_Product"
            ]
        },
        "Extract_OpportunityStage_1": {
            "action": "load",
            "parameters": {
                "dataset": {
                    "connectionName": "SFDC_LOCAL",
                    "sourceObjectName": "OpportunityStage",
                    "type": "connectedDataset"
                },
                "fields": [
                    "IsClosed",
                    "CreatedDate",
                    "Description",
                    "ForecastCategory",
                    "ForecastCategoryName",
                    "IsActive",
                    "LastModifiedDate",
                    "MasterLabel",
                    "Id",
                    "DefaultProbability",
                    "SortOrder",
                    "SystemModstamp",
                    "IsWon"
                ],
                "sampleDetails": {
                    "sortBy": [],
                    "type": "TopN"
                }
            },
            "sources": []
        },
        "Extract_OpportunityStage": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "coalesce(\"SortOrder\",null,0)",
                        "label": "SortOrder",
                        "name": "SortOrder_replace",
                        "type": "NUMBER"
                    }
                ]
            },
            "schema": {
                "fields": [
                    {
                        "name": "SortOrder_replace",
                        "newProperties": {
                            "name": "SortOrder"
                        }
                    }
                ],
                "slice": {
                    "fields": [
                        "SortOrder"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "DROP"
                }
            },
            "sources": [
                "Extract_OpportunityStage_1"
            ]
        },
        "Join_OpportunityOpportunityStage": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "StageName"
                ],
                "rightKeys": [
                    "MasterLabel"
                ],
                "rightQualifier": "Stage"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "AccountId",
                        "Name",
                        "StageName",
                        "Amount",
                        "CloseDate",
                        "Type",
                        "LeadSource",
                        "IsClosed",
                        "IsWon",
                        "ForecastCategory",
                        "ForecastCategoryName",
                        "HasOpportunityLineItem",
                        "OwnerId",
                        "CreatedDate",
                        "CreatedById",
                        "LastModifiedDate",
                        "LastActivityDate",
                        "DaysSinceLastActivity",
                        "OpportunityAge",
                        "DaysPastDue",
                        "IsPastDue",
                        "Neglected",
                        "Stage.SortOrder",
                        "Stage.DefaultProbability"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Add_Neglected_To_Opportunity",
                "Extract_OpportunityStage"
            ]
        },
        "Extract_OpportunityHistory_1": {
            "action": "load",
            "parameters": {
                "dataset": {
                    "connectionName": "SFDC_LOCAL",
                    "sourceObjectName": "OpportunityHistory",
                    "type": "connectedDataset"
                },
                "fields": [
                    "Amount",
                    "CloseDate",
                    "CreatedById",
                    "CreatedDate",
                    "ForecastCategory",
                    "Id",
                    "IsDeleted",
                    "OpportunityId",
                    "StageName"
                ],
                "sampleDetails": {
                    "sortBy": [],
                    "type": "TopN"
                }
            },
            "sources": []
        },
        "Extract_OpportunityHistory_2": {
            "action": "schema",
            "parameters": {
                "fields": [
                    {
                        "name": "Amount",
                        "newProperties": {
                            "label": "Amount",
                            "name": "Amount"
                        }
                    }
                ]
            },
            "sources": [
                "Extract_OpportunityHistory_1"
            ]
        },
        "Extract_OpportunityHistory_3": {
            "action": "schema",
            "parameters": {
                "fields": [
                    {
                        "name": "CloseDate",
                        "newProperties": {
                            "label": "CloseDate",
                            "name": "CloseDate"
                        }
                    }
                ]
            },
            "sources": [
                "Extract_OpportunityHistory_2"
            ]
        },
        "Extract_OpportunityHistory": {
            "action": "schema",
            "parameters": {
                "fields": [
                    {
                        "name": "CreatedDate",
                        "newProperties": {
                            "label": "CreatedDate",
                            "name": "CreatedDate"
                        }
                    }
                ]
            },
            "sources": [
                "Extract_OpportunityHistory_3"
            ]
        },
        "Add_Unique_Sort_Key_to_OpportunityHistory": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "",
                        "formulaExpression": "CreatedDate || '-' || Id",
                        "label": "Unique_Sort_Key",
                        "name": "Unique_Sort_Key",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Extract_OpportunityHistory"
            ]
        },
        "Compute_Historical_Trending_Fields_1": {
            "action": "computeRelative",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "",
                        "format": "dd/MM/yyyy",
                        "formulaExpression": "first_value(CreatedDate)",
                        "label": "OpportunityCreatedDate",
                        "name": "OpportunityCreatedDate",
                        "type": "DATETIME"
                    }
                ],
                "orderBy": [
                    {
                        "direction": "ASC",
                        "fieldName": "Unique_Sort_Key"
                    }
                ],
                "partitionBy": [
                    "OpportunityId"
                ]
            },
            "sources": [
                "Add_Unique_Sort_Key_to_OpportunityHistory"
            ]
        },
        "Compute_Historical_Trending_Fields_2": {
            "action": "computeRelative",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "3000-01-01T00:00:00.000Z",
                        "formulaExpression": "lead(CreatedDate)",
                        "label": "ValidToDate",
                        "name": "ValidToDate",
                        "type": "DATETIME"
                    }
                ],
                "orderBy": [
                    {
                        "direction": "ASC",
                        "fieldName": "Unique_Sort_Key"
                    }
                ],
                "partitionBy": [
                    "OpportunityId"
                ]
            },
            "sources": [
                "Compute_Historical_Trending_Fields_1"
            ]
        },
        "Compute_Historical_Trending_Fields_3": {
            "action": "computeRelative",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "",
                        "format": "dd/MM/yyyy",
                        "formulaExpression": "current(CreatedDate)",
                        "label": "ValidFromDate",
                        "name": "ValidFromDate",
                        "type": "DATETIME"
                    }
                ],
                "orderBy": [
                    {
                        "direction": "ASC",
                        "fieldName": "Unique_Sort_Key"
                    }
                ],
                "partitionBy": [
                    "OpportunityId"
                ]
            },
            "sources": [
                "Compute_Historical_Trending_Fields_2"
            ]
        },
        "Compute_Historical_Trending_Fields_4": {
            "action": "computeRelative",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "0",
                        "formulaExpression": "lag(Amount)",
                        "label": "AmountPrev",
                        "name": "AmountPrev",
                        "precision": 18,
                        "type": "NUMBER"
                    }
                ],
                "orderBy": [
                    {
                        "direction": "ASC",
                        "fieldName": "Unique_Sort_Key"
                    }
                ],
                "partitionBy": [
                    "OpportunityId"
                ]
            },
            "sources": [
                "Compute_Historical_Trending_Fields_3"
            ]
        },
        "Compute_Historical_Trending_Fields_5": {
            "action": "computeRelative",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "",
                        "formulaExpression": "lag(StageName)",
                        "label": "Prev Stage Name",
                        "name": "StageNamePrev",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ],
                "orderBy": [
                    {
                        "direction": "ASC",
                        "fieldName": "Unique_Sort_Key"
                    }
                ],
                "partitionBy": [
                    "OpportunityId"
                ]
            },
            "sources": [
                "Compute_Historical_Trending_Fields_4"
            ]
        },
        "Compute_Historical_Trending_Fields_6": {
            "action": "computeRelative",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "",
                        "formulaExpression": "lag(ForecastCategory)",
                        "label": "ForecastCategoryPrev",
                        "name": "ForecastCategoryPrev",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ],
                "orderBy": [
                    {
                        "direction": "ASC",
                        "fieldName": "Unique_Sort_Key"
                    }
                ],
                "partitionBy": [
                    "OpportunityId"
                ]
            },
            "sources": [
                "Compute_Historical_Trending_Fields_5"
            ]
        },
        "Compute_Historical_Trending_Fields_7": {
            "action": "computeRelative",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "",
                        "format": "dd/MM/yyyy",
                        "formulaExpression": "lag(CloseDate)",
                        "label": "Prev Close Date",
                        "name": "CloseDatePrev",
                        "type": "DATETIME"
                    }
                ],
                "orderBy": [
                    {
                        "direction": "ASC",
                        "fieldName": "Unique_Sort_Key"
                    }
                ],
                "partitionBy": [
                    "OpportunityId"
                ]
            },
            "sources": [
                "Compute_Historical_Trending_Fields_6"
            ]
        },
        "Compute_Historical_Trending_Fields": {
            "action": "computeRelative",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "lag(CreatedDate)",
                        "label": "Prev CreatedDate",
                        "name": "CreatedDatePrev",
                        "type": "DATETIME"
                    }
                ],
                "orderBy": [
                    {
                        "direction": "ASC",
                        "fieldName": "Unique_Sort_Key"
                    }
                ],
                "partitionBy": [
                    "OpportunityId"
                ]
            },
            "sources": [
                "Compute_Historical_Trending_Fields_7"
            ]
        },
        "Add_Fields_to_OpportunityHistory_1": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "\"1\"",
                        "formulaExpression": "case when StageName = StageNamePrev then '0' else '1' end",
                        "label": "Stage_isUpdated",
                        "name": "Stage_isUpdated",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Compute_Historical_Trending_Fields"
            ]
        },
        "Add_Fields_to_OpportunityHistory_2": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "\"1\"",
                        "formulaExpression": "case when CloseDatePrev = CloseDate then '0' else '1' end",
                        "label": "CloseDate_isUpdated",
                        "name": "CloseDate_isUpdated",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Add_Fields_to_OpportunityHistory_1"
            ]
        },
        "Add_Fields_to_OpportunityHistory_3": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "\"1\"",
                        "formulaExpression": "case when AmountPrev = Amount then '0' else '1' end",
                        "label": "Amount_isUpdated",
                        "name": "Amount_isUpdated",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Add_Fields_to_OpportunityHistory_2"
            ]
        },
        "Add_Fields_to_OpportunityHistory_4": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "case when ValidToDate = '3000-01-01T00:00:00.000Z' then '1' else '0' end",
                        "label": "IsLastUpdate",
                        "name": "IsLastUpdate",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Add_Fields_to_OpportunityHistory_3"
            ]
        },
        "Add_Fields_to_OpportunityHistory_5": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "",
                        "formulaExpression": "case when (string(CloseDatePrev) > 0) AND (CloseDatePrev < CloseDate) then 1 else 0 end",
                        "label": "IsPushed",
                        "name": "IsPushed",
                        "precision": 8,
                        "scale": 0,
                        "type": "NUMBER"
                    }
                ]
            },
            "sources": [
                "Add_Fields_to_OpportunityHistory_4"
            ]
        },
        "Add_Fields_to_OpportunityHistory_6": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "",
                        "formulaExpression": "case when (string(CloseDatePrev) > 0) AND (CloseDatePrev > CloseDate) then 1 else 0 end",
                        "label": "IsPulled",
                        "name": "IsPulled",
                        "precision": 8,
                        "scale": 0,
                        "type": "NUMBER"
                    }
                ]
            },
            "sources": [
                "Add_Fields_to_OpportunityHistory_5"
            ]
        },
        "Add_Fields_to_OpportunityHistory": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "/*\ncase when 'ValidToDate' == \"3000-01-01T00:00:00.000Z\" then     date_diff(\"second\",toDate(ValidFromDate_sec_epoch), now())     else     date_diff(\"second\",toDate(ValidFromDate_sec_epoch), toDate(ValidToDate_sec_epoch))     end\n*/\nNULL",
                        "label": "Duration",
                        "name": "Duration",
                        "precision": 18,
                        "scale": 0,
                        "type": "NUMBER"
                    }
                ]
            },
            "sources": [
                "Add_Fields_to_OpportunityHistory_6"
            ]
        },
        "Filter_Out_Stage_Updates": {
            "action": "filter",
            "parameters": {
                "filterExpressions": [
                    {
                        "field": "Stage_isUpdated",
                        "operands": [
                            "1"
                        ],
                        "operator": "EQUAL"
                    }
                ]
            },
            "sources": [
                "Add_Fields_to_OpportunityHistory"
            ]
        },
        "Find_Last_Stage_Updates": {
            "action": "computeRelative",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "current()",
                        "formulaExpression": "first_value(Id)",
                        "label": "LastStageUpdate_Id",
                        "name": "LastStageUpdate_Id",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ],
                "orderBy": [
                    {
                        "direction": "DESC",
                        "fieldName": "Unique_Sort_Key"
                    }
                ],
                "partitionBy": [
                    "OpportunityId"
                ]
            },
            "sources": [
                "Filter_Out_Stage_Updates"
            ]
        },
        "Create_IsLastStageUpdate_Field": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "case when LastStageUpdate_Id = Id then '1' else '0' end",
                        "label": "IsLastStageUpdate",
                        "name": "IsLastStageUpdate",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Find_Last_Stage_Updates"
            ]
        },
        "Filter_Out_Last_Stage_Updates": {
            "action": "filter",
            "parameters": {
                "filterExpressions": [
                    {
                        "field": "IsLastStageUpdate",
                        "operands": [
                            "1"
                        ],
                        "operator": "EQUAL"
                    }
                ]
            },
            "sources": [
                "Create_IsLastStageUpdate_Field"
            ]
        },
        "Calculate_Current_Stage_Duration": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "/*\ndate_diff(\"second\",toDate(ValidFromDate_sec_epoch), now())\n*/\nNULL",
                        "label": "Duration",
                        "name": "Duration_Seconds",
                        "precision": 18,
                        "scale": 0,
                        "type": "NUMBER"
                    }
                ]
            },
            "sources": [
                "Filter_Out_Last_Stage_Updates"
            ]
        },
        "Join_Time_In_Current_Stage_to_Opportunity": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "Id"
                ],
                "rightKeys": [
                    "OpportunityId"
                ],
                "rightQualifier": "Time_In_Current_Stage"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "AccountId",
                        "Name",
                        "StageName",
                        "Amount",
                        "CloseDate",
                        "Type",
                        "LeadSource",
                        "IsClosed",
                        "IsWon",
                        "ForecastCategory",
                        "ForecastCategoryName",
                        "HasOpportunityLineItem",
                        "OwnerId",
                        "CreatedDate",
                        "CreatedById",
                        "LastModifiedDate",
                        "LastActivityDate",
                        "DaysSinceLastActivity",
                        "OpportunityAge",
                        "DaysPastDue",
                        "IsPastDue",
                        "Neglected",
                        "Stage.SortOrder",
                        "Stage.DefaultProbability",
                        "Time_In_Current_Stage.Duration_Seconds"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Join_OpportunityOpportunityStage",
                "Calculate_Current_Stage_Duration"
            ]
        },
        "Join_OpportunityStage": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "StageName"
                ],
                "rightKeys": [
                    "MasterLabel"
                ],
                "rightQualifier": "Stage"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "OpportunityId",
                        "CreatedById",
                        "CreatedDate",
                        "StageName",
                        "Amount",
                        "CloseDate",
                        "ForecastCategory",
                        "IsDeleted",
                        "Unique_Sort_Key",
                        "OpportunityCreatedDate",
                        "ValidToDate",
                        "ValidFromDate",
                        "AmountPrev",
                        "StageNamePrev",
                        "ForecastCategoryPrev",
                        "CloseDatePrev",
                        "CreatedDatePrev",
                        "Stage_isUpdated",
                        "CloseDate_isUpdated",
                        "Amount_isUpdated",
                        "IsLastUpdate",
                        "IsPushed",
                        "IsPulled",
                        "Duration",
                        "Stage.IsClosed",
                        "Stage.IsWon",
                        "Stage.SortOrder"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Add_Fields_to_OpportunityHistory",
                "Extract_OpportunityStage"
            ]
        },
        "Join_OpportunityStage_Previous": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "StageNamePrev"
                ],
                "rightKeys": [
                    "MasterLabel"
                ],
                "rightQualifier": "StagePrev"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "OpportunityId",
                        "CreatedById",
                        "CreatedDate",
                        "StageName",
                        "Amount",
                        "CloseDate",
                        "ForecastCategory",
                        "IsDeleted",
                        "Unique_Sort_Key",
                        "OpportunityCreatedDate",
                        "ValidToDate",
                        "ValidFromDate",
                        "AmountPrev",
                        "StageNamePrev",
                        "ForecastCategoryPrev",
                        "CloseDatePrev",
                        "CreatedDatePrev",
                        "Stage_isUpdated",
                        "CloseDate_isUpdated",
                        "Amount_isUpdated",
                        "IsLastUpdate",
                        "IsPushed",
                        "IsPulled",
                        "Duration",
                        "Stage.SortOrder",
                        "Stage.IsClosed",
                        "Stage.IsWon",
                        "StagePrev.IsClosed",
                        "StagePrev.IsWon",
                        "StagePrev.SortOrder"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Join_OpportunityStage",
                "Extract_OpportunityStage"
            ]
        },
        "Create_StageName_Multi_Value_Key": {
            "action": "join",
            "parameters": {
                "joinType": "MULTI_VALUE_LOOKUP",
                "leftKeys": [
                    "Id"
                ],
                "rightKeys": [
                    "OpportunityId"
                ],
                "rightQualifier": "Stage"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "AccountId",
                        "Name",
                        "StageName",
                        "Amount",
                        "CloseDate",
                        "Type",
                        "LeadSource",
                        "IsClosed",
                        "IsWon",
                        "ForecastCategory",
                        "ForecastCategoryName",
                        "HasOpportunityLineItem",
                        "OwnerId",
                        "CreatedDate",
                        "CreatedById",
                        "LastModifiedDate",
                        "LastActivityDate",
                        "DaysSinceLastActivity",
                        "OpportunityAge",
                        "DaysPastDue",
                        "IsPastDue",
                        "Neglected",
                        "Stage.SortOrder",
                        "Stage.DefaultProbability",
                        "Time_In_Current_Stage.Duration_Seconds",
                        "Stage.StageName",
                        "Stage.IsPushed",
                        "Stage.IsPulled"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Join_Time_In_Current_Stage_to_Opportunity",
                "Join_OpportunityStage_Previous"
            ]
        },
        "Calculate_IsLost_1": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "case when IsClosed = 'true' AND IsWon = 'false' then 'Yes' else 'No' end",
                        "label": "IsLost",
                        "name": "IsLost",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Create_StageName_Multi_Value_Key"
            ]
        },
        "Calculate_IsLost": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "case when \"Stage.IsPushed\" > 0 then 'true' else 'false' end",
                        "label": "Pushed",
                        "name": "Pushed",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Calculate_IsLost_1"
            ]
        },
        "Extract_Account": {
            "action": "load",
            "parameters": {
                "dataset": {
                    "connectionName": "SFDC_LOCAL",
                    "sourceObjectName": "Account",
                    "type": "connectedDataset"
                },
                "fields": [
                    "Id",
                    "Name",
                    "OwnerId",
                    "NumberOfEmployees",
                    "AnnualRevenue",
                    "AccountSource",
                    "Type",
                    "Industry",
                    "BillingCountry",
                    "BillingState",
                    "CreatedDate",
                    "LastModifiedDate"
                ],
                "sampleDetails": {
                    "sortBy": [],
                    "type": "TopN"
                }
            },
            "sources": []
        },
        "Add_Fields_To_Account": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "Name",
                        "label": "Account Name",
                        "name": "AccountName",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Extract_Account"
            ]
        },
        "Join_AccountOwner": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "OwnerId"
                ],
                "rightKeys": [
                    "Id"
                ],
                "rightQualifier": "Owner"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "Name",
                        "Type",
                        "BillingState",
                        "BillingCountry",
                        "Industry",
                        "AnnualRevenue",
                        "NumberOfEmployees",
                        "OwnerId",
                        "CreatedDate",
                        "LastModifiedDate",
                        "AccountSource",
                        "AccountName",
                        "Owner.Name",
                        "Owner.Username",
                        "Owner.UserRoleId",
                        "Owner.UserManager.Name",
                        "Owner.UserManagerNames",
                        "Owner.UniqueUserName",
                        "Owner.UserManager.UniqueUserName",
                        "Owner.FullPhotoUrl",
                        "Owner.SmallPhotoUrl",
                        "Owner.Role.Name",
                        "Owner.Role.DeveloperName",
                        "Owner.Role.Roles",
                        "Owner.Role.RolePath",
                        "Owner.Role.ParentRoleId",
                        "Owner.Role.ParentRole.Name",
                        "Owner.Role.ParentRole.DeveloperName",
                        "Owner.Role.RoleNames",
                        "Owner.Role.RoleNamesPath",
                        "Owner.Role.Hierarchy_RoleNames"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Add_Fields_To_Account",
                "User_with_Roles"
            ]
        },
        "Join_OpportunityAccount": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "AccountId"
                ],
                "rightKeys": [
                    "Id"
                ],
                "rightQualifier": "Account"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "AccountId",
                        "Name",
                        "StageName",
                        "Amount",
                        "CloseDate",
                        "Type",
                        "LeadSource",
                        "IsClosed",
                        "IsWon",
                        "ForecastCategory",
                        "ForecastCategoryName",
                        "HasOpportunityLineItem",
                        "OwnerId",
                        "CreatedDate",
                        "CreatedById",
                        "LastModifiedDate",
                        "LastActivityDate",
                        "DaysSinceLastActivity",
                        "OpportunityAge",
                        "DaysPastDue",
                        "IsPastDue",
                        "Neglected",
                        "Stage.SortOrder",
                        "Stage.DefaultProbability",
                        "Time_In_Current_Stage.Duration_Seconds",
                        "Stage.StageName",
                        "Stage.IsPushed",
                        "Stage.IsPulled",
                        "IsLost",
                        "Pushed",
                        "Account.Name",
                        "Account.Type",
                        "Account.Industry",
                        "Account.BillingCountry",
                        "Account.BillingState",
                        "Account.AccountSource",
                        "Account.NumberOfEmployees",
                        "Account.AnnualRevenue",
                        "Account.OwnerId",
                        "Account.Owner.Name",
                        "Account.Owner.UserManager.Name",
                        "Account.Owner.UserManagerNames",
                        "Account.Owner.UserManager.UniqueUserName",
                        "Account.Owner.UniqueUserName",
                        "Account.Owner.Role.Name",
                        "Account.Owner.Role.Roles",
                        "Account.Owner.Role.RolePath",
                        "Account.Owner.Role.ParentRoleId"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Calculate_IsLost",
                "Join_AccountOwner"
            ]
        },
        "Join_OpportunityOwner": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "OwnerId"
                ],
                "rightKeys": [
                    "Id"
                ],
                "rightQualifier": "Owner"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "AccountId",
                        "Name",
                        "StageName",
                        "Amount",
                        "CloseDate",
                        "Type",
                        "LeadSource",
                        "IsClosed",
                        "IsWon",
                        "ForecastCategory",
                        "ForecastCategoryName",
                        "HasOpportunityLineItem",
                        "OwnerId",
                        "CreatedDate",
                        "CreatedById",
                        "LastModifiedDate",
                        "LastActivityDate",
                        "DaysSinceLastActivity",
                        "OpportunityAge",
                        "DaysPastDue",
                        "IsPastDue",
                        "Neglected",
                        "Stage.SortOrder",
                        "Stage.DefaultProbability",
                        "Time_In_Current_Stage.Duration_Seconds",
                        "Stage.StageName",
                        "Stage.IsPushed",
                        "Stage.IsPulled",
                        "IsLost",
                        "Pushed",
                        "Account.Name",
                        "Account.Type",
                        "Account.BillingState",
                        "Account.BillingCountry",
                        "Account.Industry",
                        "Account.AnnualRevenue",
                        "Account.NumberOfEmployees",
                        "Account.OwnerId",
                        "Account.AccountSource",
                        "Account.Owner.Name",
                        "Account.Owner.UniqueUserName",
                        "Account.Owner.UserManager.Name",
                        "Account.Owner.UserManager.UniqueUserName",
                        "Account.Owner.UserManagerNames",
                        "Account.Owner.Role.Name",
                        "Account.Owner.Role.ParentRoleId",
                        "Account.Owner.Role.Roles",
                        "Account.Owner.Role.RolePath",
                        "Owner.Name",
                        "Owner.Username",
                        "Owner.UserRoleId",
                        "Owner.UserManager.Name",
                        "Owner.UserManagerNames",
                        "Owner.UniqueUserName",
                        "Owner.UserManager.UniqueUserName",
                        "Owner.FullPhotoUrl",
                        "Owner.SmallPhotoUrl",
                        "Owner.Role.Name",
                        "Owner.Role.DeveloperName",
                        "Owner.Role.Roles",
                        "Owner.Role.RolePath",
                        "Owner.Role.ParentRoleId",
                        "Owner.Role.ParentRole.Name",
                        "Owner.Role.ParentRole.DeveloperName",
                        "Owner.Role.RoleNames",
                        "Owner.Role.RoleNamesPath",
                        "Owner.Role.Hierarchy_RoleNames"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Join_OpportunityAccount",
                "User_with_Roles"
            ]
        },
        "Opportunity_add_closed_won": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "\"NA\"",
                        "formulaExpression": "case when IsWon = 'true' then 'Closed Won' when IsLost = 'Yes' then 'Lost' when IsClosed = 'false' then 'Open' else 'NA' end",
                        "label": "OpenClosedWonLost",
                        "name": "OpenClosedWonLost",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Join_OpportunityOwner"
            ]
        },
        "Join_OpportunityOpportunityLineItemPricebookEntryProduct": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "OpportunityId"
                ],
                "rightKeys": [
                    "Id"
                ],
                "rightQualifier": "Opportunity"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "OpportunityId",
                        "PricebookEntryId",
                        "ProductCode",
                        "Quantity",
                        "TotalPrice",
                        "ListPrice",
                        "ServiceDate",
                        "Id",
                        "Discount_Percent",
                        "Total_ListPrice",
                        "Pricebook.Product2Id",
                        "Product.Name",
                        "Product.ProductCode",
                        "Product.Family",
                        "Opportunity.Name",
                        "Opportunity.StageName",
                        "Opportunity.CloseDate",
                        "Opportunity.Type",
                        "Opportunity.IsClosed",
                        "Opportunity.LeadSource",
                        "Opportunity.ForecastCategory",
                        "Opportunity.ForecastCategoryName",
                        "Opportunity.CreatedDate",
                        "Opportunity.AccountId",
                        "Opportunity.Account.Name",
                        "Opportunity.Account.OwnerId",
                        "Opportunity.Account.Type",
                        "Opportunity.Account.Industry",
                        "Opportunity.Account.BillingCountry",
                        "Opportunity.Account.BillingState",
                        "Opportunity.Account.AccountSource",
                        "Opportunity.Account.NumberOfEmployees",
                        "Opportunity.Account.AnnualRevenue",
                        "Opportunity.Account.Owner.Name",
                        "Opportunity.Account.Owner.UniqueUserName",
                        "Opportunity.Account.Owner.Role.Name",
                        "Opportunity.Account.Owner.Role.Roles",
                        "Opportunity.Account.Owner.Role.RolePath",
                        "Opportunity.OwnerId",
                        "Opportunity.Owner.Name",
                        "Opportunity.Owner.FullPhotoUrl",
                        "Opportunity.Owner.SmallPhotoUrl",
                        "Opportunity.Owner.UserManager.Name",
                        "Opportunity.Owner.UserManagerNames",
                        "Opportunity.Owner.UserManager.UniqueUserName",
                        "Opportunity.Owner.UniqueUserName",
                        "Opportunity.Owner.Role.Name",
                        "Opportunity.Owner.Role.DeveloperName",
                        "Opportunity.Owner.Role.Roles",
                        "Opportunity.Owner.Role.RoleNames",
                        "Opportunity.Owner.Role.Hierarchy_RoleNames",
                        "Opportunity.Owner.Role.RolePath",
                        "Opportunity.Owner.Role.ParentRoleId",
                        "Opportunity.Owner.Role.ParentRole.DeveloperName",
                        "Opportunity.OpportunityAge",
                        "Opportunity.Stage.IsPushed",
                        "Opportunity.Pushed",
                        "Opportunity.Stage.IsPulled",
                        "Opportunity.DaysSinceLastActivity",
                        "Opportunity.DaysPastDue",
                        "Opportunity.IsPastDue",
                        "Opportunity.Neglected",
                        "Opportunity.IsWon",
                        "Opportunity.IsLost",
                        "Opportunity.OpenClosedWonLost"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Join_OpportunityLineItemPricebookEntryProduct",
                "Opportunity_add_closed_won"
            ]
        },
        "Add_Fields_To_Oppty_Product": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "\"Opportunity.Account.Name\"",
                        "label": "AccountName",
                        "name": "AccountName",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Join_OpportunityOpportunityLineItemPricebookEntryProduct"
            ]
        },
        "Join_ActivityOwner_Product": {
            "action": "join",
            "parameters": {
                "joinType": "MULTI_VALUE_LOOKUP",
                "leftKeys": [
                    "WhatId"
                ],
                "rightKeys": [
                    "OpportunityId"
                ],
                "rightQualifier": "Opportunity"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "WhatId",
                        "Subject",
                        "ActivityDate",
                        "Status",
                        "Priority",
                        "OwnerId",
                        "AccountId",
                        "IsClosed",
                        "CreatedDate",
                        "LastModifiedDate",
                        "CallDurationInSeconds",
                        "CallType",
                        "CallDisposition",
                        "TaskSubtype",
                        "EventSubtype",
                        "DurationInMinutes",
                        "Owner.Username",
                        "Owner.Name",
                        "Owner.UserRoleId",
                        "Owner.FullPhotoUrl",
                        "Owner.SmallPhotoUrl",
                        "Owner.UniqueUserName",
                        "Owner.UserManager.Name",
                        "Owner.UserManager.UniqueUserName",
                        "Owner.UserManagerNames",
                        "Owner.Role.Name",
                        "Owner.Role.ParentRoleId",
                        "Owner.Role.DeveloperName",
                        "Owner.Role.Roles",
                        "Owner.Role.RolePath",
                        "Owner.Role.ParentRole.Name",
                        "Owner.Role.ParentRole.DeveloperName",
                        "Owner.Role.RoleNames",
                        "Owner.Role.RoleNamesPath",
                        "Owner.Role.Hierarchy_RoleNames",
                        "Opportunity.Product.Family",
                        "Opportunity.Product.Name"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Join_ActivityOwner",
                "Add_Fields_To_Oppty_Product"
            ]
        },
        "Join_ActivityOwner_Product_Opp": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "WhatId"
                ],
                "rightKeys": [
                    "Id"
                ],
                "rightQualifier": "Opportunity"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "WhatId",
                        "Subject",
                        "ActivityDate",
                        "Status",
                        "Priority",
                        "OwnerId",
                        "AccountId",
                        "IsClosed",
                        "CreatedDate",
                        "LastModifiedDate",
                        "CallDurationInSeconds",
                        "CallType",
                        "CallDisposition",
                        "TaskSubtype",
                        "EventSubtype",
                        "DurationInMinutes",
                        "Owner.Username",
                        "Owner.Name",
                        "Owner.UserRoleId",
                        "Owner.FullPhotoUrl",
                        "Owner.SmallPhotoUrl",
                        "Owner.UniqueUserName",
                        "Owner.UserManager.Name",
                        "Owner.UserManager.UniqueUserName",
                        "Owner.UserManagerNames",
                        "Owner.Role.Name",
                        "Owner.Role.ParentRoleId",
                        "Owner.Role.DeveloperName",
                        "Owner.Role.Roles",
                        "Owner.Role.RolePath",
                        "Owner.Role.ParentRole.Name",
                        "Owner.Role.ParentRole.DeveloperName",
                        "Owner.Role.RoleNames",
                        "Owner.Role.RoleNamesPath",
                        "Owner.Role.Hierarchy_RoleNames",
                        "Opportunity.Product.Name",
                        "Opportunity.Product.Family",
                        "Opportunity.Id",
                        "Opportunity.StageName",
                        "Opportunity.Name",
                        "Opportunity.Type",
                        "Opportunity.OwnerId",
                        "Opportunity.AccountId",
                        "Opportunity.CloseDate",
                        "Opportunity.CreatedDate",
                        "Opportunity.LeadSource",
                        "Opportunity.ForecastCategoryName",
                        "Opportunity.Account.Name",
                        "Opportunity.Account.Type",
                        "Opportunity.Account.Industry",
                        "Opportunity.Account.AccountSource",
                        "Opportunity.Account.BillingCountry",
                        "Opportunity.Account.BillingState",
                        "Opportunity.Account.OwnerId",
                        "Opportunity.OpportunityAge",
                        "Opportunity.DaysSinceLastActivity",
                        "Opportunity.DaysPastDue",
                        "Opportunity.IsPastDue",
                        "Opportunity.Neglected",
                        "Opportunity.IsWon",
                        "Opportunity.IsLost",
                        "Opportunity.IsClosed",
                        "Opportunity.OpenClosedWonLost"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Join_ActivityOwner_Product",
                "Opportunity_add_closed_won"
            ]
        },
        "Join_ActivityOwner_Product_Opp_User": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "OwnerId"
                ],
                "rightKeys": [
                    "Id"
                ],
                "rightQualifier": "AssignedTo"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "WhatId",
                        "Subject",
                        "ActivityDate",
                        "Status",
                        "Priority",
                        "OwnerId",
                        "AccountId",
                        "IsClosed",
                        "CreatedDate",
                        "LastModifiedDate",
                        "CallDurationInSeconds",
                        "CallType",
                        "CallDisposition",
                        "TaskSubtype",
                        "EventSubtype",
                        "DurationInMinutes",
                        "Owner.Username",
                        "Owner.Name",
                        "Owner.UserRoleId",
                        "Owner.FullPhotoUrl",
                        "Owner.SmallPhotoUrl",
                        "Owner.UniqueUserName",
                        "Owner.UserManager.Name",
                        "Owner.UserManager.UniqueUserName",
                        "Owner.UserManagerNames",
                        "Owner.Role.Name",
                        "Owner.Role.ParentRoleId",
                        "Owner.Role.DeveloperName",
                        "Owner.Role.Roles",
                        "Owner.Role.RolePath",
                        "Owner.Role.ParentRole.Name",
                        "Owner.Role.ParentRole.DeveloperName",
                        "Owner.Role.RoleNames",
                        "Owner.Role.RoleNamesPath",
                        "Owner.Role.Hierarchy_RoleNames",
                        "Opportunity.Product.Name",
                        "Opportunity.Product.Family",
                        "Opportunity.Id",
                        "Opportunity.AccountId",
                        "Opportunity.Name",
                        "Opportunity.StageName",
                        "Opportunity.CloseDate",
                        "Opportunity.Type",
                        "Opportunity.LeadSource",
                        "Opportunity.IsClosed",
                        "Opportunity.IsWon",
                        "Opportunity.ForecastCategoryName",
                        "Opportunity.OwnerId",
                        "Opportunity.CreatedDate",
                        "Opportunity.DaysSinceLastActivity",
                        "Opportunity.OpportunityAge",
                        "Opportunity.DaysPastDue",
                        "Opportunity.IsPastDue",
                        "Opportunity.Neglected",
                        "Opportunity.IsLost",
                        "Opportunity.Account.Name",
                        "Opportunity.Account.Type",
                        "Opportunity.Account.BillingState",
                        "Opportunity.Account.BillingCountry",
                        "Opportunity.Account.Industry",
                        "Opportunity.Account.OwnerId",
                        "Opportunity.Account.AccountSource",
                        "Opportunity.OpenClosedWonLost",
                        "AssignedTo.Name",
                        "AssignedTo.UniqueUserName"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Join_ActivityOwner_Product_Opp",
                "Flatten_UserManager"
            ]
        },
        "Join_ActivityOwner_Product_Opp_User_Account": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "AccountId"
                ],
                "rightKeys": [
                    "Id"
                ],
                "rightQualifier": "Account"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "WhatId",
                        "Subject",
                        "ActivityDate",
                        "Status",
                        "Priority",
                        "OwnerId",
                        "AccountId",
                        "IsClosed",
                        "CreatedDate",
                        "LastModifiedDate",
                        "CallDurationInSeconds",
                        "CallType",
                        "CallDisposition",
                        "TaskSubtype",
                        "EventSubtype",
                        "DurationInMinutes",
                        "Owner.Username",
                        "Owner.Name",
                        "Owner.UserRoleId",
                        "Owner.FullPhotoUrl",
                        "Owner.SmallPhotoUrl",
                        "Owner.UniqueUserName",
                        "Owner.UserManager.Name",
                        "Owner.UserManager.UniqueUserName",
                        "Owner.UserManagerNames",
                        "Owner.Role.Name",
                        "Owner.Role.ParentRoleId",
                        "Owner.Role.DeveloperName",
                        "Owner.Role.Roles",
                        "Owner.Role.RolePath",
                        "Owner.Role.ParentRole.Name",
                        "Owner.Role.ParentRole.DeveloperName",
                        "Owner.Role.RoleNames",
                        "Owner.Role.RoleNamesPath",
                        "Owner.Role.Hierarchy_RoleNames",
                        "Opportunity.Product.Name",
                        "Opportunity.Product.Family",
                        "Opportunity.Id",
                        "Opportunity.AccountId",
                        "Opportunity.Name",
                        "Opportunity.StageName",
                        "Opportunity.CloseDate",
                        "Opportunity.Type",
                        "Opportunity.LeadSource",
                        "Opportunity.IsClosed",
                        "Opportunity.IsWon",
                        "Opportunity.ForecastCategoryName",
                        "Opportunity.OwnerId",
                        "Opportunity.CreatedDate",
                        "Opportunity.DaysSinceLastActivity",
                        "Opportunity.OpportunityAge",
                        "Opportunity.DaysPastDue",
                        "Opportunity.IsPastDue",
                        "Opportunity.Neglected",
                        "Opportunity.IsLost",
                        "Opportunity.Account.Name",
                        "Opportunity.Account.Type",
                        "Opportunity.Account.BillingState",
                        "Opportunity.Account.BillingCountry",
                        "Opportunity.Account.Industry",
                        "Opportunity.Account.OwnerId",
                        "Opportunity.Account.AccountSource",
                        "Opportunity.OpenClosedWonLost",
                        "AssignedTo.Name",
                        "AssignedTo.UniqueUserName",
                        "Account.Name",
                        "Account.Type",
                        "Account.Industry",
                        "Account.BillingCountry",
                        "Account.BillingState",
                        "Account.AccountSource",
                        "Account.NumberOfEmployees",
                        "Account.AnnualRevenue",
                        "Account.OwnerId",
                        "Account.Owner.Name",
                        "Account.Owner.UserManager.Name",
                        "Account.Owner.UserManagerNames",
                        "Account.Owner.UserManager.UniqueUserName",
                        "Account.Owner.UniqueUserName",
                        "Account.Owner.Role.Name",
                        "Account.Owner.Role.Roles",
                        "Account.Owner.Role.RolePath",
                        "Account.Owner.Role.ParentRoleId"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Join_ActivityOwner_Product_Opp_User",
                "Join_AccountOwner"
            ]
        },
        "Compute_Activity_IsOverdue": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "case when (IsClosed = 'false') AND (dateDiff(to_timestamp(substr(ActivityDate, 1, 10), 'yyyy-MM-dd'), now()) > 0) then 'true' else 'false' end",
                        "label": "IsOverdue",
                        "name": "IsOverdue",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Join_ActivityOwner_Product_Opp_User_Account"
            ]
        },
        "Compute_Activity_Days_Overdue": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "0",
                        "formulaExpression": "case when IsOverdue = 'true' then dateDiff(to_timestamp(substr(ActivityDate, 1, 10), 'yyyy-MM-dd'), now()) else 0 end",
                        "label": "Days Overdue",
                        "name": "DaysOverdue",
                        "precision": 18,
                        "scale": 2,
                        "type": "NUMBER"
                    }
                ]
            },
            "sources": [
                "Compute_Activity_IsOverdue"
            ]
        },
        "Activity_Custom_Filter_Flag": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "'true'",
                        "label": "CustomFilter",
                        "name": "CustomFilter",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Compute_Activity_Days_Overdue"
            ]
        },
        "Filter_Activity": {
            "action": "filter",
            "parameters": {
                "filterExpressions": [
                    {
                        "field": "CustomFilter",
                        "operands": [
                            "true"
                        ],
                        "operator": "EQUAL"
                    }
                ]
            },
            "sources": [
                "Activity_Custom_Filter_Flag"
            ]
        },
        "Register_Activity": {
            "action": "save",
            "parameters": {
                "dataset": {
                    "label": "*Activities",
                    "name": "activity_df2R3",
                    "rowLevelSecurityFilter": "'Owner.Role.Roles' == \"$User.UserRoleId\" || 'OwnerId' == \"$User.Id\" || 'Opportunity.Account.OwnerId' == \"$User.Id\"",
                    "type": "analyticsDataset"
                },
                "fields": [],
                "measuresToCurrencies": []
            },
            "sources": [
                "Filter_Activity"
            ]
        },
        "Register_UserRole": {
            "action": "save",
            "parameters": {
                "dataset": {
                    "label": "*Roles",
                    "name": "user_role_df2R3",
                    "type": "analyticsDataset"
                },
                "fields": [],
                "measuresToCurrencies": []
            },
            "sources": [
                "Flatten_Hierarchy_Grouping"
            ]
        },
        "Register_Product": {
            "action": "save",
            "parameters": {
                "dataset": {
                    "label": "*Products",
                    "name": "product_df2R3",
                    "type": "analyticsDataset"
                },
                "fields": [],
                "measuresToCurrencies": []
            },
            "sources": [
                "Extract_Product"
            ]
        },
        "Account_Custom_Filter_Flag": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "'true'",
                        "label": "CustomFilter",
                        "name": "CustomFilter",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Join_AccountOwner"
            ]
        },
        "Filter_Account": {
            "action": "filter",
            "parameters": {
                "filterExpressions": [
                    {
                        "field": "CustomFilter",
                        "operands": [
                            "true"
                        ],
                        "operator": "EQUAL"
                    }
                ]
            },
            "sources": [
                "Account_Custom_Filter_Flag"
            ]
        },
        "Join_OpportunityOwner_Product": {
            "action": "join",
            "parameters": {
                "joinType": "MULTI_VALUE_LOOKUP",
                "leftKeys": [
                    "Id"
                ],
                "rightKeys": [
                    "OpportunityId"
                ],
                "rightQualifier": "Product"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "AccountId",
                        "Name",
                        "StageName",
                        "Amount",
                        "CloseDate",
                        "Type",
                        "LeadSource",
                        "IsClosed",
                        "IsWon",
                        "ForecastCategory",
                        "ForecastCategoryName",
                        "HasOpportunityLineItem",
                        "OwnerId",
                        "CreatedDate",
                        "CreatedById",
                        "LastModifiedDate",
                        "LastActivityDate",
                        "DaysSinceLastActivity",
                        "OpportunityAge",
                        "DaysPastDue",
                        "IsPastDue",
                        "Neglected",
                        "Stage.SortOrder",
                        "Stage.DefaultProbability",
                        "Time_In_Current_Stage.Duration_Seconds",
                        "Stage.StageName",
                        "Stage.IsPushed",
                        "Stage.IsPulled",
                        "IsLost",
                        "Pushed",
                        "Account.Name",
                        "Account.Type",
                        "Account.BillingState",
                        "Account.BillingCountry",
                        "Account.Industry",
                        "Account.AnnualRevenue",
                        "Account.NumberOfEmployees",
                        "Account.OwnerId",
                        "Account.AccountSource",
                        "Account.Owner.Name",
                        "Account.Owner.UniqueUserName",
                        "Account.Owner.UserManager.Name",
                        "Account.Owner.UserManager.UniqueUserName",
                        "Account.Owner.UserManagerNames",
                        "Account.Owner.Role.Name",
                        "Account.Owner.Role.ParentRoleId",
                        "Account.Owner.Role.Roles",
                        "Account.Owner.Role.RolePath",
                        "Owner.Username",
                        "Owner.Name",
                        "Owner.UserRoleId",
                        "Owner.FullPhotoUrl",
                        "Owner.SmallPhotoUrl",
                        "Owner.UniqueUserName",
                        "Owner.UserManager.Name",
                        "Owner.UserManager.UniqueUserName",
                        "Owner.UserManagerNames",
                        "Owner.Role.Name",
                        "Owner.Role.ParentRoleId",
                        "Owner.Role.DeveloperName",
                        "Owner.Role.Roles",
                        "Owner.Role.RolePath",
                        "Owner.Role.ParentRole.Name",
                        "Owner.Role.ParentRole.DeveloperName",
                        "Owner.Role.RoleNames",
                        "Owner.Role.RoleNamesPath",
                        "Owner.Role.Hierarchy_RoleNames",
                        "OpenClosedWonLost",
                        "Product.Product.Family",
                        "Product.Product.Name"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Opportunity_add_closed_won",
                "Add_Fields_To_Oppty_Product"
            ]
        },
        "Opportunity_Custom_Filter_Flag": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "'true'",
                        "label": "CustomFilter",
                        "name": "CustomFilter",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Join_OpportunityOwner_Product"
            ]
        },
        "Filter_Opportunity": {
            "action": "filter",
            "parameters": {
                "filterExpressions": [
                    {
                        "field": "CustomFilter",
                        "operands": [
                            "true"
                        ],
                        "operator": "EQUAL"
                    }
                ]
            },
            "sources": [
                "Opportunity_Custom_Filter_Flag"
            ]
        },
        "Join_Account_Opportunity": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "Id"
                ],
                "rightKeys": [
                    "AccountId"
                ],
                "rightQualifier": "Opportunity"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "Name",
                        "Type",
                        "BillingState",
                        "BillingCountry",
                        "Industry",
                        "AnnualRevenue",
                        "NumberOfEmployees",
                        "OwnerId",
                        "CreatedDate",
                        "LastModifiedDate",
                        "AccountSource",
                        "AccountName",
                        "Owner.Username",
                        "Owner.Name",
                        "Owner.UserRoleId",
                        "Owner.FullPhotoUrl",
                        "Owner.SmallPhotoUrl",
                        "Owner.UniqueUserName",
                        "Owner.UserManager.Name",
                        "Owner.UserManager.UniqueUserName",
                        "Owner.UserManagerNames",
                        "Owner.Role.Name",
                        "Owner.Role.ParentRoleId",
                        "Owner.Role.DeveloperName",
                        "Owner.Role.Roles",
                        "Owner.Role.RolePath",
                        "Owner.Role.ParentRole.Name",
                        "Owner.Role.ParentRole.DeveloperName",
                        "Owner.Role.RoleNames",
                        "Owner.Role.RoleNamesPath",
                        "Owner.Role.Hierarchy_RoleNames",
                        "CustomFilter",
                        "Opportunity.Id",
                        "Opportunity.Name",
                        "Opportunity.Owner.Name"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Filter_Account",
                "Filter_Opportunity"
            ]
        },
        "Account_with_Opportunity_Flag": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "case when \"Opportunity.Name\" IS NULL then 'false' else 'true' end",
                        "label": "hasOpportunity",
                        "name": "hasOpportunity",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Join_Account_Opportunity"
            ]
        },
        "Slice_Fields_From_Account": {
            "action": "schema",
            "parameters": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Opportunity.Id",
                        "Opportunity.Name",
                        "Opportunity.Owner.Name"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "DROP"
                }
            },
            "sources": [
                "Account_with_Opportunity_Flag"
            ]
        },
        "Register_Account": {
            "action": "save",
            "parameters": {
                "dataset": {
                    "label": "*Accounts",
                    "name": "account_df2R3",
                    "rowLevelSecurityFilter": "'Owner.Role.Roles' == \"$User.UserRoleId\" || 'OwnerId' == \"$User.Id\"",
                    "type": "analyticsDataset"
                },
                "fields": [],
                "measuresToCurrencies": []
            },
            "sources": [
                "Slice_Fields_From_Account"
            ]
        },
        "User_with_Roles_with_Opportunities": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "Id"
                ],
                "rightKeys": [
                    "OwnerId"
                ],
                "rightQualifier": "Opportunity"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "Username",
                        "LastName",
                        "FirstName",
                        "Name",
                        "IsActive",
                        "UserRoleId",
                        "UserType",
                        "ManagerId",
                        "FullPhotoUrl",
                        "SmallPhotoUrl",
                        "isDuplicate",
                        "UniqueUserName",
                        "UserManager.Id",
                        "UserManager.Username",
                        "UserManager.Name",
                        "UserManager.UserRoleId",
                        "UserManager.FullPhotoUrl",
                        "UserManager.SmallPhotoUrl",
                        "UserManager.UniqueUserName",
                        "UserManagerNames",
                        "ManagerNamesPath",
                        "Role.Name",
                        "Role.ParentRoleId",
                        "Role.DeveloperName",
                        "Role.Roles",
                        "Role.RolePath",
                        "Role.ParentRole.Name",
                        "Role.ParentRole.DeveloperName",
                        "Role.RoleNames",
                        "Role.RoleNamesPath",
                        "Role.Hierarchy_RoleNames",
                        "Opportunity.Name"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "User_with_Roles",
                "Extract_Opportunity"
            ]
        },
        "Users_Custom_Filter_Flag_1": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "case when \"Opportunity.Name\" IS NULL then 'false' else 'true' end",
                        "label": "hasOpportunity",
                        "name": "hasOpportunity",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "User_with_Roles_with_Opportunities"
            ]
        },
        "Users_Custom_Filter_Flag": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "case when \"Opportunity.Name\" IS NULL AND IsActive = 'false' then 'false' else 'true' end",
                        "label": "CustomFilter",
                        "name": "CustomFilter",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Users_Custom_Filter_Flag_1"
            ]
        },
        "Filter_UserManager": {
            "action": "filter",
            "parameters": {
                "filterExpressions": [
                    {
                        "field": "CustomFilter",
                        "operands": [
                            "true"
                        ],
                        "operator": "EQUAL"
                    }
                ]
            },
            "sources": [
                "Users_Custom_Filter_Flag"
            ]
        },
        "Register_User": {
            "action": "save",
            "parameters": {
                "dataset": {
                    "label": "*Users",
                    "name": "user_df2R3",
                    "rowLevelSecurityFilter": "'Role.Roles' == \"$User.UserRoleId\" || 'Id' == \"$User.Id\"",
                    "type": "analyticsDataset"
                },
                "fields": [],
                "measuresToCurrencies": []
            },
            "sources": [
                "Filter_UserManager"
            ]
        },
        "Opportunity_Products_Custom_Filter_Flag": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "'true'",
                        "label": "CustomFilter",
                        "name": "CustomFilter",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Add_Fields_To_Oppty_Product"
            ]
        },
        "Filter_Opportunity_Products": {
            "action": "filter",
            "parameters": {
                "filterExpressions": [
                    {
                        "field": "CustomFilter",
                        "operands": [
                            "true"
                        ],
                        "operator": "EQUAL"
                    }
                ]
            },
            "sources": [
                "Opportunity_Products_Custom_Filter_Flag"
            ]
        },
        "Register_OpportunityProducts": {
            "action": "save",
            "parameters": {
                "dataset": {
                    "label": "*Oppty Products",
                    "name": "opportunity_products_df2R3",
                    "rowLevelSecurityFilter": "'Opportunity.Owner.Role.Roles' == \"$User.UserRoleId\" || 'Opportunity.OwnerId' == \"$User.Id\" || 'Opportunity.Account.OwnerId' == \"$User.Id\"",
                    "type": "analyticsDataset"
                },
                "fields": [],
                "measuresToCurrencies": []
            },
            "sources": [
                "Filter_Opportunity_Products"
            ]
        },
        "Register_Opportunity": {
            "action": "save",
            "parameters": {
                "dataset": {
                    "label": "*Opportunities",
                    "name": "opportunity_df2R3",
                    "rowLevelSecurityFilter": "'Owner.Role.Roles' == \"$User.UserRoleId\" || 'OwnerId' == \"$User.Id\" || 'Account.OwnerId' == \"$User.Id\"",
                    "type": "analyticsDataset"
                },
                "fields": [],
                "measuresToCurrencies": []
            },
            "sources": [
                "EDIT_ATTRIBUTES0"
            ]
        },
        "Join_ForecastCategory": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "ForecastCategory"
                ],
                "rightKeys": [
                    "ForecastCategory"
                ],
                "rightQualifier": "ForecastCategory"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "OpportunityId",
                        "CreatedById",
                        "CreatedDate",
                        "StageName",
                        "Amount",
                        "CloseDate",
                        "ForecastCategory",
                        "IsDeleted",
                        "Unique_Sort_Key",
                        "OpportunityCreatedDate",
                        "ValidToDate",
                        "ValidFromDate",
                        "AmountPrev",
                        "StageNamePrev",
                        "ForecastCategoryPrev",
                        "CloseDatePrev",
                        "CreatedDatePrev",
                        "Stage_isUpdated",
                        "CloseDate_isUpdated",
                        "Amount_isUpdated",
                        "IsLastUpdate",
                        "IsPushed",
                        "IsPulled",
                        "Duration",
                        "Stage.SortOrder",
                        "Stage.IsClosed",
                        "Stage.IsWon",
                        "StagePrev.SortOrder",
                        "StagePrev.IsClosed",
                        "StagePrev.IsWon",
                        "ForecastCategory.ForecastCategoryName"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Join_OpportunityStage_Previous",
                "Extract_OpportunityStage"
            ]
        },
        "Join_ForecastCategory_Previous": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "ForecastCategoryPrev"
                ],
                "rightKeys": [
                    "ForecastCategory"
                ],
                "rightQualifier": "ForecastCategoryPrev"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "OpportunityId",
                        "CreatedById",
                        "CreatedDate",
                        "StageName",
                        "Amount",
                        "CloseDate",
                        "ForecastCategory",
                        "IsDeleted",
                        "Unique_Sort_Key",
                        "OpportunityCreatedDate",
                        "ValidToDate",
                        "ValidFromDate",
                        "AmountPrev",
                        "StageNamePrev",
                        "ForecastCategoryPrev",
                        "CloseDatePrev",
                        "CreatedDatePrev",
                        "Stage_isUpdated",
                        "CloseDate_isUpdated",
                        "Amount_isUpdated",
                        "IsLastUpdate",
                        "IsPushed",
                        "IsPulled",
                        "Duration",
                        "Stage.SortOrder",
                        "Stage.IsClosed",
                        "Stage.IsWon",
                        "StagePrev.SortOrder",
                        "StagePrev.IsClosed",
                        "StagePrev.IsWon",
                        "ForecastCategory.ForecastCategoryName",
                        "ForecastCategoryPrev.ForecastCategoryName"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Join_ForecastCategory",
                "Extract_OpportunityStage"
            ]
        },
        "Join_Time_In_Current_Stage_to_Pipeline_Trending": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "OpportunityId"
                ],
                "rightKeys": [
                    "OpportunityId"
                ],
                "rightQualifier": "Time_In_Current_Stage"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "OpportunityId",
                        "CreatedById",
                        "CreatedDate",
                        "StageName",
                        "Amount",
                        "CloseDate",
                        "ForecastCategory",
                        "IsDeleted",
                        "Unique_Sort_Key",
                        "OpportunityCreatedDate",
                        "ValidToDate",
                        "ValidFromDate",
                        "AmountPrev",
                        "StageNamePrev",
                        "ForecastCategoryPrev",
                        "CloseDatePrev",
                        "CreatedDatePrev",
                        "Stage_isUpdated",
                        "CloseDate_isUpdated",
                        "Amount_isUpdated",
                        "IsLastUpdate",
                        "IsPushed",
                        "IsPulled",
                        "Duration",
                        "Stage.SortOrder",
                        "Stage.IsClosed",
                        "Stage.IsWon",
                        "StagePrev.SortOrder",
                        "StagePrev.IsClosed",
                        "StagePrev.IsWon",
                        "ForecastCategory.ForecastCategoryName",
                        "ForecastCategoryPrev.ForecastCategoryName",
                        "Time_In_Current_Stage.Duration_Seconds"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Join_ForecastCategory_Previous",
                "Calculate_Current_Stage_Duration"
            ]
        },
        "Join_OpportunityStage_Previous_with_Opp": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "OpportunityId"
                ],
                "rightKeys": [
                    "Id"
                ],
                "rightQualifier": "Opportunity"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Id",
                        "OpportunityId",
                        "CreatedById",
                        "CreatedDate",
                        "StageName",
                        "Amount",
                        "CloseDate",
                        "ForecastCategory",
                        "IsDeleted",
                        "Unique_Sort_Key",
                        "OpportunityCreatedDate",
                        "ValidToDate",
                        "ValidFromDate",
                        "AmountPrev",
                        "StageNamePrev",
                        "ForecastCategoryPrev",
                        "CloseDatePrev",
                        "CreatedDatePrev",
                        "Stage_isUpdated",
                        "CloseDate_isUpdated",
                        "Amount_isUpdated",
                        "IsLastUpdate",
                        "IsPushed",
                        "IsPulled",
                        "Duration",
                        "Stage.SortOrder",
                        "Stage.IsClosed",
                        "Stage.IsWon",
                        "StagePrev.SortOrder",
                        "StagePrev.IsClosed",
                        "StagePrev.IsWon",
                        "ForecastCategory.ForecastCategoryName",
                        "ForecastCategoryPrev.ForecastCategoryName",
                        "Time_In_Current_Stage.Duration_Seconds",
                        "Opportunity.Name",
                        "Opportunity.StageName",
                        "Opportunity.Id",
                        "Opportunity.Type",
                        "Opportunity.Stage.SortOrder",
                        "Opportunity.OwnerId",
                        "Opportunity.AccountId",
                        "Opportunity.CloseDate",
                        "Opportunity.LeadSource",
                        "Opportunity.ForecastCategoryName",
                        "Opportunity.Account.Name",
                        "Opportunity.Account.Type",
                        "Opportunity.Account.Industry",
                        "Opportunity.Account.AccountSource",
                        "Opportunity.Account.BillingState",
                        "Opportunity.Account.BillingCountry",
                        "Opportunity.Account.OwnerId",
                        "Opportunity.Account.Owner.Name",
                        "Opportunity.Owner.Name",
                        "Opportunity.Owner.FullPhotoUrl",
                        "Opportunity.Owner.SmallPhotoUrl",
                        "Opportunity.Owner.UserManager.Name",
                        "Opportunity.Owner.UserManagerNames",
                        "Opportunity.Owner.UserManager.UniqueUserName",
                        "Opportunity.Owner.UniqueUserName",
                        "Opportunity.Owner.Role.RoleNames",
                        "Opportunity.Owner.Role.Hierarchy_RoleNames",
                        "Opportunity.Owner.Role.Name",
                        "Opportunity.Owner.Role.DeveloperName",
                        "Opportunity.Owner.Role.Roles",
                        "Opportunity.Owner.Role.RolePath",
                        "Opportunity.Owner.Role.ParentRoleId",
                        "Opportunity.Owner.Role.ParentRole.Name",
                        "Opportunity.Owner.Role.ParentRole.DeveloperName",
                        "Opportunity.IsWon",
                        "Opportunity.IsLost",
                        "Opportunity.IsClosed",
                        "Opportunity.OpenClosedWonLost"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "SELECT"
                }
            },
            "sources": [
                "Join_Time_In_Current_Stage_to_Pipeline_Trending",
                "Opportunity_add_closed_won"
            ]
        },
        "Extract_OpportunityAmount": {
            "action": "load",
            "parameters": {
                "dataset": {
                    "connectionName": "SFDC_LOCAL",
                    "sourceObjectName": "Opportunity",
                    "type": "connectedDataset"
                },
                "fields": [
                    "Id",
                    "Amount"
                ],
                "sampleDetails": {
                    "sortBy": [],
                    "type": "TopN"
                }
            },
            "sources": []
        },
        "Join_OpportunityStage_Previous_with_Opp_Amount": {
            "action": "join",
            "parameters": {
                "joinType": "LOOKUP",
                "leftKeys": [
                    "OpportunityId"
                ],
                "rightKeys": [
                    "Id"
                ],
                "rightQualifier": "Extract_OpportunityAmount"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [],
                    "ignoreMissingFields": true,
                    "mode": "DROP"
                }
            },
            "sources": [
                "Join_OpportunityStage_Previous_with_Opp",
                "Extract_OpportunityAmount"
            ]
        },
        "Join_OpportunityStage_Previous_with_Opp_Amount_Product": {
            "action": "join",
            "parameters": {
                "joinType": "MULTI_VALUE_LOOKUP",
                "leftKeys": [
                    "OpportunityId"
                ],
                "rightKeys": [
                    "OpportunityId"
                ],
                "rightQualifier": "Add_Fields_To_Oppty_Product"
            },
            "schema": {
                "fields": [],
                "slice": {
                    "fields": [
                        "Add_Fields_To_Oppty_Product.Id",
                        "Add_Fields_To_Oppty_Product.OpportunityId",
                        "Add_Fields_To_Oppty_Product.ProductCode",
                        "Add_Fields_To_Oppty_Product.ListPrice",
                        "Add_Fields_To_Oppty_Product.Quantity",
                        "Add_Fields_To_Oppty_Product.TotalPrice",
                        "Add_Fields_To_Oppty_Product.PricebookEntryId",
                        "Add_Fields_To_Oppty_Product.ServiceDate",
                        "Add_Fields_To_Oppty_Product.Id",
                        "Add_Fields_To_Oppty_Product.Discount_Percent",
                        "Add_Fields_To_Oppty_Product.Total_ListPrice",
                        "Add_Fields_To_Oppty_Product.Pricebook.Product2Id",
                        "Add_Fields_To_Oppty_Product.Product.ProductCode",
                        "Add_Fields_To_Oppty_Product.Opportunity.AccountId",
                        "Add_Fields_To_Oppty_Product.Opportunity.OwnerId",
                        "Add_Fields_To_Oppty_Product.Opportunity.Name",
                        "Add_Fields_To_Oppty_Product.Opportunity.StageName",
                        "Add_Fields_To_Oppty_Product.Opportunity.LeadSource",
                        "Add_Fields_To_Oppty_Product.Opportunity.IsWon",
                        "Add_Fields_To_Oppty_Product.Opportunity.Type",
                        "Add_Fields_To_Oppty_Product.Opportunity.IsClosed",
                        "Add_Fields_To_Oppty_Product.Opportunity.ForecastCategory",
                        "Add_Fields_To_Oppty_Product.Opportunity.ForecastCategoryName",
                        "Add_Fields_To_Oppty_Product.Opportunity.CreatedDate",
                        "Add_Fields_To_Oppty_Product.Opportunity.CloseDate",
                        "Add_Fields_To_Oppty_Product.Opportunity.DaysSinceLastActivity",
                        "Add_Fields_To_Oppty_Product.Opportunity.OpportunityAge",
                        "Add_Fields_To_Oppty_Product.Opportunity.DaysPastDue",
                        "Add_Fields_To_Oppty_Product.Opportunity.IsPastDue",
                        "Add_Fields_To_Oppty_Product.Opportunity.Neglected",
                        "Add_Fields_To_Oppty_Product.Opportunity.Stage.IsPushed",
                        "Add_Fields_To_Oppty_Product.Opportunity.Stage.IsPulled",
                        "Add_Fields_To_Oppty_Product.Opportunity.IsLost",
                        "Add_Fields_To_Oppty_Product.Opportunity.Pushed",
                        "Add_Fields_To_Oppty_Product.Opportunity.Account.Name",
                        "Add_Fields_To_Oppty_Product.Opportunity.Account.OwnerId",
                        "Add_Fields_To_Oppty_Product.Opportunity.Account.NumberOfEmployees",
                        "Add_Fields_To_Oppty_Product.Opportunity.Account.AnnualRevenue",
                        "Add_Fields_To_Oppty_Product.Opportunity.Account.AccountSource",
                        "Add_Fields_To_Oppty_Product.Opportunity.Account.Type",
                        "Add_Fields_To_Oppty_Product.Opportunity.Account.Industry",
                        "Add_Fields_To_Oppty_Product.Opportunity.Account.BillingCountry",
                        "Add_Fields_To_Oppty_Product.Opportunity.Account.BillingState",
                        "Add_Fields_To_Oppty_Product.Opportunity.Account.Owner.Name",
                        "Add_Fields_To_Oppty_Product.Opportunity.Account.Owner.UniqueUserName",
                        "Add_Fields_To_Oppty_Product.Opportunity.Account.Owner.Role.Name",
                        "Add_Fields_To_Oppty_Product.Opportunity.Account.Owner.Role.RolePath",
                        "Add_Fields_To_Oppty_Product.Opportunity.Account.Owner.Role.Roles",
                        "Add_Fields_To_Oppty_Product.Opportunity.Owner.Name",
                        "Add_Fields_To_Oppty_Product.Opportunity.Owner.FullPhotoUrl",
                        "Add_Fields_To_Oppty_Product.Opportunity.Owner.SmallPhotoUrl",
                        "Add_Fields_To_Oppty_Product.Opportunity.Owner.UniqueUserName",
                        "Add_Fields_To_Oppty_Product.Opportunity.Owner.UserManager.Name",
                        "Add_Fields_To_Oppty_Product.Opportunity.Owner.UserManager.UniqueUserName",
                        "Add_Fields_To_Oppty_Product.Opportunity.Owner.UserManagerNames",
                        "Add_Fields_To_Oppty_Product.Opportunity.Owner.Role.Name",
                        "Add_Fields_To_Oppty_Product.Opportunity.Owner.Role.DeveloperName",
                        "Add_Fields_To_Oppty_Product.Opportunity.Owner.Role.ParentRoleId",
                        "Add_Fields_To_Oppty_Product.Opportunity.Owner.Role.RolePath",
                        "Add_Fields_To_Oppty_Product.Opportunity.Owner.Role.Roles",
                        "Add_Fields_To_Oppty_Product.Opportunity.Owner.Role.ParentRole.DeveloperName",
                        "Add_Fields_To_Oppty_Product.Opportunity.Owner.Role.RoleNames",
                        "Add_Fields_To_Oppty_Product.Opportunity.Owner.Role.Hierarchy_RoleNames",
                        "Add_Fields_To_Oppty_Product.Opportunity.OpenClosedWonLost",
                        "Add_Fields_To_Oppty_Product.AccountName"
                    ],
                    "ignoreMissingFields": true,
                    "mode": "DROP"
                }
            },
            "sources": [
                "Join_OpportunityStage_Previous_with_Opp_Amount",
                "Add_Fields_To_Oppty_Product"
            ]
        },
        "Pipeline_Trending_Custom_Filter_Flag": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "formulaExpression": "'true'",
                        "label": "CustomFilter",
                        "name": "CustomFilter",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Join_OpportunityStage_Previous_with_Opp_Amount_Product"
            ]
        },
        "Pipeline_Trending_Stage_Conversion_Flag": {
            "action": "formula",
            "parameters": {
                "expressionType": "SQL",
                "fields": [
                    {
                        "defaultValue": "\"true\"",
                        "formulaExpression": "case when \"Stage.SortOrder\" > \"StagePrev.SortOrder\" then 'true' else 'false' end",
                        "label": "Stage_IsAdvanced",
                        "name": "Stage_IsAdvanced",
                        "precision": 255,
                        "type": "TEXT"
                    }
                ]
            },
            "sources": [
                "Pipeline_Trending_Custom_Filter_Flag"
            ]
        },
        "Filter_Pipeline_Trending": {
            "action": "filter",
            "parameters": {
                "filterExpressions": [
                    {
                        "field": "CustomFilter",
                        "operands": [
                            "true"
                        ],
                        "operator": "EQUAL"
                    }
                ]
            },
            "sources": [
                "Pipeline_Trending_Stage_Conversion_Flag"
            ]
        },
        "Register_PipelineTrending": {
            "action": "save",
            "parameters": {
                "dataset": {
                    "label": "*Pipeline Trending",
                    "name": "pipeline_trending_df2R3",
                    "rowLevelSecurityFilter": "'Opportunity.Owner.Role.Roles' == \"$User.UserRoleId\" || 'Opportunity.OwnerId' == \"$User.Id\" || 'Opportunity.Account.OwnerId' == \"$User.Id\"",
                    "type": "analyticsDataset"
                },
                "fields": [],
                "measuresToCurrencies": []
            },
            "sources": [
                "Filter_Pipeline_Trending"
            ]
        },
        "EDIT_ATTRIBUTES0": {
            "action": "schema",
            "parameters": {
                "fields": [
                    {
                        "name": "Name",
                        "newProperties": {
                            "label": "Opportunity Name",
                            "name": "Opportunity_Name"
                        }
                    }
                ]
            },
            "sources": [
                "Filter_Opportunity"
            ]
        }
    },
    "ui": {
        "nodes": {
            "Extract_Task_1": {
                "label": "Extract_Task_1",
                "type": "LOAD_DATASET",
                "top": 952,
                "left": 1232,
                "parameters": {
                    "sampleSize": 2000
                }
            },
            "TRANSFORM0": {
                "label": "Extract_Task-transform",
                "type": "TRANSFORM",
                "top": 952,
                "left": 1372,
                "graph": {
                    "Extract_Task_2": null,
                    "Extract_Task": null
                },
                "connectors": [
                    {
                        "source": "Extract_Task_2",
                        "target": "Extract_Task"
                    }
                ]
            },
            "TRANSFORM1": {
                "label": "Add_Fields_To_Task",
                "type": "TRANSFORM",
                "top": 952,
                "left": 1512,
                "graph": {
                    "Add_Fields_To_Task_1": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Add_Fields_To_Task": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": [
                    {
                        "source": "Add_Fields_To_Task_1",
                        "target": "Add_Fields_To_Task"
                    }
                ]
            },
            "Extract_Event_1": {
                "label": "Extract_Event_1",
                "type": "LOAD_DATASET",
                "top": 1092,
                "left": 1232,
                "parameters": {
                    "sampleSize": 2000
                }
            },
            "TRANSFORM2": {
                "label": "Extract_Event-transform",
                "type": "TRANSFORM",
                "top": 1092,
                "left": 1372,
                "graph": {
                    "Extract_Event_2": null,
                    "Extract_Event": null
                },
                "connectors": [
                    {
                        "source": "Extract_Event_2",
                        "target": "Extract_Event"
                    }
                ]
            },
            "TRANSFORM3": {
                "label": "Add_Fields_To_Event",
                "type": "TRANSFORM",
                "top": 1092,
                "left": 1512,
                "graph": {
                    "Add_Fields_To_Event_1": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Add_Fields_To_Event_2": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Add_Fields_To_Event_3": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Add_Fields_To_Event_4": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Add_Fields_To_Event_5": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Add_Fields_To_Event_6": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Add_Fields_To_Event": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        },
                        "label": "Formula"
                    }
                },
                "connectors": [
                    {
                        "source": "Add_Fields_To_Event_1",
                        "target": "Add_Fields_To_Event_2"
                    },
                    {
                        "source": "Add_Fields_To_Event_2",
                        "target": "Add_Fields_To_Event_3"
                    },
                    {
                        "source": "Add_Fields_To_Event_3",
                        "target": "Add_Fields_To_Event_4"
                    },
                    {
                        "source": "Add_Fields_To_Event_4",
                        "target": "Add_Fields_To_Event_5"
                    },
                    {
                        "source": "Add_Fields_To_Event_5",
                        "target": "Add_Fields_To_Event_6"
                    },
                    {
                        "source": "Add_Fields_To_Event_6",
                        "target": "Add_Fields_To_Event"
                    }
                ]
            },
            "Append_TaskEvent": {
                "label": "Append_TaskEvent",
                "type": "APPEND",
                "top": 952,
                "left": 1652
            },
            "Extract_User_1": {
                "label": "Extract_User_1",
                "type": "LOAD_DATASET",
                "top": 392,
                "left": 672,
                "parameters": {
                    "sampleSize": 2000
                }
            },
            "TRANSFORM4": {
                "label": "Extract_User-transform",
                "type": "TRANSFORM",
                "top": 392,
                "left": 812,
                "graph": {
                    "Extract_User": {
                        "parameters": {
                            "type": "REPLACE_UI"
                        }
                    }
                },
                "connectors": []
            },
            "Filter_User": {
                "label": "Filter_User",
                "type": "FILTER",
                "top": 392,
                "left": 952
            },
            "TRANSFORM5": {
                "label": "Compute_Unique_Name",
                "type": "TRANSFORM",
                "top": 392,
                "left": 1092,
                "graph": {
                    "Compute_Unique_Name": {
                        "label": "Formula"
                    }
                },
                "connectors": []
            },
            "TRANSFORM6": {
                "label": "Compute_Manager_Unique",
                "type": "TRANSFORM",
                "top": 392,
                "left": 1232,
                "graph": {
                    "Compute_Manager_Unique": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": []
            },
            "Join_User_Manager": {
                "label": "Join_User_Manager",
                "type": "JOIN",
                "top": 392,
                "left": 1372
            },
            "TRANSFORM7": {
                "label": "Flatten_UserManager",
                "type": "TRANSFORM",
                "top": 392,
                "left": 1512,
                "graph": {
                    "Flatten_UserManager": null
                },
                "connectors": []
            },
            "Extract_UserRole": {
                "label": "Extract_UserRole",
                "type": "LOAD_DATASET",
                "top": 672,
                "left": 952,
                "parameters": {
                    "sampleSize": 2000
                }
            },
            "TRANSFORM8": {
                "label": "Flatten_UserRole",
                "type": "TRANSFORM",
                "top": 672,
                "left": 1092,
                "graph": {
                    "Flatten_UserRole": null
                },
                "connectors": []
            },
            "Augment_ParentName": {
                "label": "Augment_ParentName",
                "type": "JOIN",
                "top": 672,
                "left": 1232
            },
            "TRANSFORM9": {
                "label": "Flatten_ParentName",
                "type": "TRANSFORM",
                "top": 672,
                "left": 1372,
                "graph": {
                    "Flatten_ParentName": null
                },
                "connectors": []
            },
            "TRANSFORM10": {
                "label": "Flatten_Hierarchy_Grouping",
                "type": "TRANSFORM",
                "top": 672,
                "left": 1512,
                "graph": {
                    "Flatten_Hierarchy_Grouping": null
                },
                "connectors": []
            },
            "User_with_Roles": {
                "label": "User_with_Roles",
                "type": "JOIN",
                "top": 392,
                "left": 1652
            },
            "Join_ActivityOwner": {
                "label": "Join_ActivityOwner",
                "type": "JOIN",
                "top": 1092,
                "left": 1792
            },
            "Extract_OpportunityLineItem": {
                "label": "Extract_OpportunityLineItem",
                "type": "LOAD_DATASET",
                "top": 1372,
                "left": 1652,
                "parameters": {
                    "sampleSize": 2000
                }
            },
            "Extract_Opportunity_1": {
                "label": "Extract_Opportunity_1",
                "type": "LOAD_DATASET",
                "top": 252,
                "left": 812,
                "parameters": {
                    "sampleSize": 2000
                }
            },
            "TRANSFORM11": {
                "label": "Extract_Opportunity-transform",
                "type": "TRANSFORM",
                "top": 252,
                "left": 952,
                "graph": {
                    "Extract_Opportunity_2": null,
                    "Extract_Opportunity": null
                },
                "connectors": [
                    {
                        "source": "Extract_Opportunity_2",
                        "target": "Extract_Opportunity"
                    }
                ]
            },
            "TRANSFORM12": {
                "label": "Add_Fields_To_Opportunity",
                "type": "TRANSFORM",
                "top": 252,
                "left": 1092,
                "graph": {
                    "Add_Fields_To_Opportunity_1": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Add_Fields_To_Opportunity_2": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        },
                        "label": "Formula"
                    },
                    "Add_Fields_To_Opportunity_3": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        },
                        "label": "Formula"
                    },
                    "Add_Fields_To_Opportunity": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        },
                        "label": "Formula"
                    }
                },
                "connectors": [
                    {
                        "source": "Add_Fields_To_Opportunity_1",
                        "target": "Add_Fields_To_Opportunity_2"
                    },
                    {
                        "source": "Add_Fields_To_Opportunity_2",
                        "target": "Add_Fields_To_Opportunity_3"
                    },
                    {
                        "source": "Add_Fields_To_Opportunity_3",
                        "target": "Add_Fields_To_Opportunity"
                    }
                ]
            },
            "TRANSFORM13": {
                "label": "Add_Neglected_To_Opportunity",
                "type": "TRANSFORM",
                "top": 252,
                "left": 1232,
                "graph": {
                    "Add_Neglected_To_Opportunity": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": []
            },
            "Opportunities_No_Products": {
                "label": "Opportunities_No_Products",
                "type": "FILTER",
                "top": 252,
                "left": 1372
            },
            "TRANSFORM14": {
                "label": "Compute_Opportunities_No_Products",
                "type": "TRANSFORM",
                "top": 252,
                "left": 1512,
                "graph": {
                    "Compute_Opportunities_No_Products_1": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Compute_Opportunities_No_Products_2": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Compute_Opportunities_No_Products_3": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Compute_Opportunities_No_Products_4": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Compute_Opportunities_No_Products_5": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Compute_Opportunities_No_Products_6": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Compute_Opportunities_No_Products_7": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        },
                        "label": "Formula"
                    },
                    "Compute_Opportunities_No_Products": null
                },
                "connectors": [
                    {
                        "source": "Compute_Opportunities_No_Products_1",
                        "target": "Compute_Opportunities_No_Products_2"
                    },
                    {
                        "source": "Compute_Opportunities_No_Products_2",
                        "target": "Compute_Opportunities_No_Products_3"
                    },
                    {
                        "source": "Compute_Opportunities_No_Products_3",
                        "target": "Compute_Opportunities_No_Products_4"
                    },
                    {
                        "source": "Compute_Opportunities_No_Products_4",
                        "target": "Compute_Opportunities_No_Products_5"
                    },
                    {
                        "source": "Compute_Opportunities_No_Products_5",
                        "target": "Compute_Opportunities_No_Products_6"
                    },
                    {
                        "source": "Compute_Opportunities_No_Products_6",
                        "target": "Compute_Opportunities_No_Products_7"
                    },
                    {
                        "source": "Compute_Opportunities_No_Products_7",
                        "target": "Compute_Opportunities_No_Products"
                    }
                ]
            },
            "TRANSFORM15": {
                "label": "Compute_Opportunities_No_Products_Id",
                "type": "TRANSFORM",
                "top": 252,
                "left": 1652,
                "graph": {
                    "Compute_Opportunities_No_Products_Id": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": []
            },
            "Append_LineItems": {
                "label": "Append_LineItems",
                "type": "APPEND",
                "top": 252,
                "left": 1792
            },
            "TRANSFORM16": {
                "label": "Discount_Field",
                "type": "TRANSFORM",
                "top": 252,
                "left": 1932,
                "graph": {
                    "Discount_Field_1": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Discount_Field": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": [
                    {
                        "source": "Discount_Field_1",
                        "target": "Discount_Field"
                    }
                ]
            },
            "Extract_PricebookEntry": {
                "label": "Extract_PricebookEntry",
                "type": "LOAD_DATASET",
                "top": 392,
                "left": 1932,
                "parameters": {
                    "sampleSize": 2000
                }
            },
            "Join_OpportunityLineItemPricebookEntry": {
                "label": "Join_OpportunityLineItemPricebookEntry",
                "type": "JOIN",
                "top": 252,
                "left": 2072
            },
            "Extract_Product": {
                "label": "Extract_Product",
                "type": "LOAD_DATASET",
                "top": 392,
                "left": 2072,
                "parameters": {
                    "sampleSize": 2000
                }
            },
            "Join_OpportunityLineItemPricebookEntryProduct": {
                "label": "Join_OpportunityLineItemPricebookEntryProduct",
                "type": "JOIN",
                "top": 252,
                "left": 2212
            },
            "Extract_OpportunityStage_1": {
                "label": "Extract_OpportunityStage_1",
                "type": "LOAD_DATASET",
                "top": 952,
                "left": 672,
                "parameters": {
                    "sampleSize": 2000
                }
            },
            "TRANSFORM17": {
                "label": "Extract_OpportunityStage-transform",
                "type": "TRANSFORM",
                "top": 952,
                "left": 812,
                "graph": {
                    "Extract_OpportunityStage": {
                        "parameters": {
                            "type": "FILL_UI"
                        }
                    }
                },
                "connectors": []
            },
            "Join_OpportunityOpportunityStage": {
                "label": "Join_OpportunityOpportunityStage",
                "type": "JOIN",
                "top": 1372,
                "left": 952
            },
            "Extract_OpportunityHistory_1": {
                "label": "Extract_OpportunityHistory_1",
                "type": "LOAD_DATASET",
                "top": 112,
                "left": 112,
                "parameters": {
                    "sampleSize": 2000
                }
            },
            "TRANSFORM18": {
                "label": "Extract_OpportunityHistory-transform",
                "type": "TRANSFORM",
                "top": 112,
                "left": 252,
                "graph": {
                    "Extract_OpportunityHistory_2": null,
                    "Extract_OpportunityHistory_3": null,
                    "Extract_OpportunityHistory": null
                },
                "connectors": [
                    {
                        "source": "Extract_OpportunityHistory_2",
                        "target": "Extract_OpportunityHistory_3"
                    },
                    {
                        "source": "Extract_OpportunityHistory_3",
                        "target": "Extract_OpportunityHistory"
                    }
                ]
            },
            "TRANSFORM19": {
                "label": "Add_Unique_Sort_Key_to_OpportunityHistory",
                "type": "TRANSFORM",
                "top": 112,
                "left": 392,
                "graph": {
                    "Add_Unique_Sort_Key_to_OpportunityHistory": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        },
                        "label": "Formula"
                    }
                },
                "connectors": []
            },
            "TRANSFORM20": {
                "label": "Compute_Historical_Trending_Fields",
                "type": "TRANSFORM",
                "top": 112,
                "left": 532,
                "graph": {
                    "Compute_Historical_Trending_Fields_1": {
                        "label": "Formula"
                    },
                    "Compute_Historical_Trending_Fields_2": null,
                    "Compute_Historical_Trending_Fields_3": {
                        "label": "Formula"
                    },
                    "Compute_Historical_Trending_Fields_4": null,
                    "Compute_Historical_Trending_Fields_5": {
                        "label": "Formula"
                    },
                    "Compute_Historical_Trending_Fields_6": {
                        "label": "Formula"
                    },
                    "Compute_Historical_Trending_Fields_7": {
                        "label": "Formula"
                    },
                    "Compute_Historical_Trending_Fields": null
                },
                "connectors": [
                    {
                        "source": "Compute_Historical_Trending_Fields_1",
                        "target": "Compute_Historical_Trending_Fields_2"
                    },
                    {
                        "source": "Compute_Historical_Trending_Fields_2",
                        "target": "Compute_Historical_Trending_Fields_3"
                    },
                    {
                        "source": "Compute_Historical_Trending_Fields_3",
                        "target": "Compute_Historical_Trending_Fields_4"
                    },
                    {
                        "source": "Compute_Historical_Trending_Fields_4",
                        "target": "Compute_Historical_Trending_Fields_5"
                    },
                    {
                        "source": "Compute_Historical_Trending_Fields_5",
                        "target": "Compute_Historical_Trending_Fields_6"
                    },
                    {
                        "source": "Compute_Historical_Trending_Fields_6",
                        "target": "Compute_Historical_Trending_Fields_7"
                    },
                    {
                        "source": "Compute_Historical_Trending_Fields_7",
                        "target": "Compute_Historical_Trending_Fields"
                    }
                ]
            },
            "TRANSFORM21": {
                "label": "Add_Fields_to_OpportunityHistory",
                "type": "TRANSFORM",
                "top": 112,
                "left": 672,
                "graph": {
                    "Add_Fields_to_OpportunityHistory_1": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Add_Fields_to_OpportunityHistory_2": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Add_Fields_to_OpportunityHistory_3": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Add_Fields_to_OpportunityHistory_4": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Add_Fields_to_OpportunityHistory_5": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        },
                        "label": "Formula"
                    },
                    "Add_Fields_to_OpportunityHistory_6": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        },
                        "label": "Formula"
                    },
                    "Add_Fields_to_OpportunityHistory": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": [
                    {
                        "source": "Add_Fields_to_OpportunityHistory_1",
                        "target": "Add_Fields_to_OpportunityHistory_2"
                    },
                    {
                        "source": "Add_Fields_to_OpportunityHistory_2",
                        "target": "Add_Fields_to_OpportunityHistory_3"
                    },
                    {
                        "source": "Add_Fields_to_OpportunityHistory_3",
                        "target": "Add_Fields_to_OpportunityHistory_4"
                    },
                    {
                        "source": "Add_Fields_to_OpportunityHistory_4",
                        "target": "Add_Fields_to_OpportunityHistory_5"
                    },
                    {
                        "source": "Add_Fields_to_OpportunityHistory_5",
                        "target": "Add_Fields_to_OpportunityHistory_6"
                    },
                    {
                        "source": "Add_Fields_to_OpportunityHistory_6",
                        "target": "Add_Fields_to_OpportunityHistory"
                    }
                ]
            },
            "Filter_Out_Stage_Updates": {
                "label": "Filter_Out_Stage_Updates",
                "type": "FILTER",
                "top": 112,
                "left": 812
            },
            "TRANSFORM22": {
                "label": "Find_Last_Stage_Updates",
                "type": "TRANSFORM",
                "top": 112,
                "left": 952,
                "graph": {
                    "Find_Last_Stage_Updates": {
                        "label": "Formula"
                    }
                },
                "connectors": []
            },
            "TRANSFORM23": {
                "label": "Create_IsLastStageUpdate_Field",
                "type": "TRANSFORM",
                "top": 112,
                "left": 1092,
                "graph": {
                    "Create_IsLastStageUpdate_Field": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": []
            },
            "Filter_Out_Last_Stage_Updates": {
                "label": "Filter_Out_Last_Stage_Updates",
                "type": "FILTER",
                "top": 112,
                "left": 1232
            },
            "TRANSFORM24": {
                "label": "Calculate_Current_Stage_Duration",
                "type": "TRANSFORM",
                "top": 112,
                "left": 1372,
                "graph": {
                    "Calculate_Current_Stage_Duration": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": []
            },
            "Join_Time_In_Current_Stage_to_Opportunity": {
                "label": "Join_Time_In_Current_Stage_to_Opportunity",
                "type": "JOIN",
                "top": 112,
                "left": 1512
            },
            "Join_OpportunityStage": {
                "label": "Join_OpportunityStage",
                "type": "JOIN",
                "top": 812,
                "left": 952
            },
            "Join_OpportunityStage_Previous": {
                "label": "Join_OpportunityStage_Previous",
                "type": "JOIN",
                "top": 812,
                "left": 1092
            },
            "Create_StageName_Multi_Value_Key": {
                "label": "Create_StageName_Multi_Value_Key",
                "type": "JOIN",
                "top": 112,
                "left": 1652
            },
            "TRANSFORM25": {
                "label": "Calculate_IsLost",
                "type": "TRANSFORM",
                "top": 112,
                "left": 1792,
                "graph": {
                    "Calculate_IsLost_1": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Calculate_IsLost": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": [
                    {
                        "source": "Calculate_IsLost_1",
                        "target": "Calculate_IsLost"
                    }
                ]
            },
            "Extract_Account": {
                "label": "Extract_Account",
                "type": "LOAD_DATASET",
                "top": 812,
                "left": 1512,
                "parameters": {
                    "sampleSize": 2000
                }
            },
            "TRANSFORM26": {
                "label": "Add_Fields_To_Account",
                "type": "TRANSFORM",
                "top": 812,
                "left": 1652,
                "graph": {
                    "Add_Fields_To_Account": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": []
            },
            "Join_AccountOwner": {
                "label": "Join_AccountOwner",
                "type": "JOIN",
                "top": 392,
                "left": 1792
            },
            "Join_OpportunityAccount": {
                "label": "Join_OpportunityAccount",
                "type": "JOIN",
                "top": 112,
                "left": 1932
            },
            "Join_OpportunityOwner": {
                "label": "Join_OpportunityOwner",
                "type": "JOIN",
                "top": 112,
                "left": 2072
            },
            "TRANSFORM27": {
                "label": "Opportunity_add_closed_won",
                "type": "TRANSFORM",
                "top": 112,
                "left": 2212,
                "graph": {
                    "Opportunity_add_closed_won": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": []
            },
            "Join_OpportunityOpportunityLineItemPricebookEntryProduct": {
                "label": "Join_OpportunityOpportunityLineItemPricebookEntryProduct",
                "type": "JOIN",
                "top": 112,
                "left": 2352
            },
            "TRANSFORM28": {
                "label": "Add_Fields_To_Oppty_Product",
                "type": "TRANSFORM",
                "top": 112,
                "left": 2492,
                "graph": {
                    "Add_Fields_To_Oppty_Product": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": []
            },
            "Join_ActivityOwner_Product": {
                "label": "Join_ActivityOwner_Product",
                "type": "JOIN",
                "top": 112,
                "left": 2632
            },
            "Join_ActivityOwner_Product_Opp": {
                "label": "Join_ActivityOwner_Product_Opp",
                "type": "JOIN",
                "top": 112,
                "left": 2772
            },
            "Join_ActivityOwner_Product_Opp_User": {
                "label": "Join_ActivityOwner_Product_Opp_User",
                "type": "JOIN",
                "top": 112,
                "left": 2912
            },
            "Join_ActivityOwner_Product_Opp_User_Account": {
                "label": "Join_ActivityOwner_Product_Opp_User_Account",
                "type": "JOIN",
                "top": 112,
                "left": 3052
            },
            "TRANSFORM29": {
                "label": "Compute_Activity_IsOverdue",
                "type": "TRANSFORM",
                "top": 112,
                "left": 3192,
                "graph": {
                    "Compute_Activity_IsOverdue": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": []
            },
            "TRANSFORM30": {
                "label": "Compute_Activity_Days_Overdue",
                "type": "TRANSFORM",
                "top": 112,
                "left": 3332,
                "graph": {
                    "Compute_Activity_Days_Overdue": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": []
            },
            "TRANSFORM31": {
                "label": "Activity_Custom_Filter_Flag",
                "type": "TRANSFORM",
                "top": 112,
                "left": 3472,
                "graph": {
                    "Activity_Custom_Filter_Flag": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": []
            },
            "Filter_Activity": {
                "label": "Filter_Activity",
                "type": "FILTER",
                "top": 112,
                "left": 3612
            },
            "Register_Activity": {
                "label": "Register_Activity",
                "type": "OUTPUT",
                "top": 112,
                "left": 3752
            },
            "Register_UserRole": {
                "label": "Register_UserRole",
                "type": "OUTPUT",
                "top": 1232,
                "left": 1652
            },
            "Register_Product": {
                "label": "Register_Product",
                "type": "OUTPUT",
                "top": 812,
                "left": 2212
            },
            "TRANSFORM32": {
                "label": "Account_Custom_Filter_Flag",
                "type": "TRANSFORM",
                "top": 812,
                "left": 2772,
                "graph": {
                    "Account_Custom_Filter_Flag": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": []
            },
            "Filter_Account": {
                "label": "Filter_Account",
                "type": "FILTER",
                "top": 812,
                "left": 2912
            },
            "Join_OpportunityOwner_Product": {
                "label": "Join_OpportunityOwner_Product",
                "type": "JOIN",
                "top": 252,
                "left": 2632
            },
            "TRANSFORM33": {
                "label": "Opportunity_Custom_Filter_Flag",
                "type": "TRANSFORM",
                "top": 252,
                "left": 2772,
                "graph": {
                    "Opportunity_Custom_Filter_Flag": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": []
            },
            "Filter_Opportunity": {
                "label": "Filter_Opportunity",
                "type": "FILTER",
                "top": 252,
                "left": 2912
            },
            "Join_Account_Opportunity": {
                "label": "Join_Account_Opportunity",
                "type": "JOIN",
                "top": 252,
                "left": 3052
            },
            "TRANSFORM34": {
                "label": "Account_with_Opportunity_Flag",
                "type": "TRANSFORM",
                "top": 252,
                "left": 3192,
                "graph": {
                    "Account_with_Opportunity_Flag": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": []
            },
            "TRANSFORM35": {
                "label": "Slice_Fields_From_Account",
                "type": "TRANSFORM",
                "top": 252,
                "left": 3332,
                "graph": {
                    "Slice_Fields_From_Account": null
                },
                "connectors": []
            },
            "Register_Account": {
                "label": "Register_Account",
                "type": "OUTPUT",
                "top": 252,
                "left": 3472
            },
            "User_with_Roles_with_Opportunities": {
                "label": "User_with_Roles_with_Opportunities",
                "type": "JOIN",
                "top": 672,
                "left": 1792
            },
            "TRANSFORM36": {
                "label": "Users_Custom_Filter_Flag",
                "type": "TRANSFORM",
                "top": 672,
                "left": 1932,
                "graph": {
                    "Users_Custom_Filter_Flag_1": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    },
                    "Users_Custom_Filter_Flag": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": [
                    {
                        "source": "Users_Custom_Filter_Flag_1",
                        "target": "Users_Custom_Filter_Flag"
                    }
                ]
            },
            "Filter_UserManager": {
                "label": "Filter_UserManager",
                "type": "FILTER",
                "top": 672,
                "left": 2072
            },
            "Register_User": {
                "label": "Register_User",
                "type": "OUTPUT",
                "top": 672,
                "left": 2212
            },
            "TRANSFORM37": {
                "label": "Opportunity_Products_Custom_Filter_Flag",
                "type": "TRANSFORM",
                "top": 532,
                "left": 2632,
                "graph": {
                    "Opportunity_Products_Custom_Filter_Flag": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": []
            },
            "Filter_Opportunity_Products": {
                "label": "Filter_Opportunity_Products",
                "type": "FILTER",
                "top": 532,
                "left": 2772
            },
            "Register_OpportunityProducts": {
                "label": "Register_OpportunityProducts",
                "type": "OUTPUT",
                "top": 532,
                "left": 2912
            },
            "Register_Opportunity": {
                "label": "Register_Opportunity",
                "type": "OUTPUT",
                "top": 392,
                "left": 3052
            },
            "Join_ForecastCategory": {
                "label": "Join_ForecastCategory",
                "type": "JOIN",
                "top": 812,
                "left": 1232
            },
            "Join_ForecastCategory_Previous": {
                "label": "Join_ForecastCategory_Previous",
                "type": "JOIN",
                "top": 812,
                "left": 1372
            },
            "Join_Time_In_Current_Stage_to_Pipeline_Trending": {
                "label": "Join_Time_In_Current_Stage_to_Pipeline_Trending",
                "type": "JOIN",
                "top": 532,
                "left": 1512
            },
            "Join_OpportunityStage_Previous_with_Opp": {
                "label": "Join_OpportunityStage_Previous_with_Opp",
                "type": "JOIN",
                "top": 532,
                "left": 1652
            },
            "Extract_OpportunityAmount": {
                "label": "Extract_OpportunityAmount",
                "type": "LOAD_DATASET",
                "top": 672,
                "left": 1652,
                "parameters": {
                    "sampleSize": 2000
                }
            },
            "Join_OpportunityStage_Previous_with_Opp_Amount": {
                "label": "Join_OpportunityStage_Previous_with_Opp_Amount",
                "type": "JOIN",
                "top": 532,
                "left": 1792
            },
            "Join_OpportunityStage_Previous_with_Opp_Amount_Product": {
                "label": "Join_OpportunityStage_Previous_with_Opp_Amount_Product",
                "type": "JOIN",
                "top": 532,
                "left": 1932
            },
            "TRANSFORM38": {
                "label": "Pipeline_Trending_Custom_Filter_Flag",
                "type": "TRANSFORM",
                "top": 532,
                "left": 2072,
                "graph": {
                    "Pipeline_Trending_Custom_Filter_Flag": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": []
            },
            "TRANSFORM39": {
                "label": "Pipeline_Trending_Stage_Conversion_Flag",
                "type": "TRANSFORM",
                "top": 532,
                "left": 2212,
                "graph": {
                    "Pipeline_Trending_Stage_Conversion_Flag": {
                        "parameters": {
                            "type": "BASE_FORMULA_UI"
                        }
                    }
                },
                "connectors": []
            },
            "Filter_Pipeline_Trending": {
                "label": "Filter_Pipeline_Trending",
                "type": "FILTER",
                "top": 532,
                "left": 2352
            },
            "Register_PipelineTrending": {
                "label": "Register_PipelineTrending",
                "type": "OUTPUT",
                "top": 532,
                "left": 2492
            },
            "TRANSFORM40": {
                "label": "Custom Opp Transformations",
                "description": "",
                "type": "TRANSFORM",
                "top": 392,
                "left": 2912,
                "graph": {
                    "EDIT_ATTRIBUTES0": {
                        "label": "Edit Attributes"
                    }
                },
                "connectors": []
            }
        },
        "connectors": [
            {
                "source": "Extract_Task_1",
                "target": "TRANSFORM0"
            },
            {
                "source": "TRANSFORM0",
                "target": "TRANSFORM1"
            },
            {
                "source": "Extract_Event_1",
                "target": "TRANSFORM2"
            },
            {
                "source": "TRANSFORM2",
                "target": "TRANSFORM3"
            },
            {
                "source": "TRANSFORM1",
                "target": "Append_TaskEvent"
            },
            {
                "source": "TRANSFORM3",
                "target": "Append_TaskEvent"
            },
            {
                "source": "Extract_User_1",
                "target": "TRANSFORM4"
            },
            {
                "source": "TRANSFORM4",
                "target": "Filter_User"
            },
            {
                "source": "Filter_User",
                "target": "TRANSFORM5"
            },
            {
                "source": "TRANSFORM5",
                "target": "TRANSFORM6"
            },
            {
                "source": "TRANSFORM6",
                "target": "Join_User_Manager"
            },
            {
                "source": "TRANSFORM6",
                "target": "Join_User_Manager"
            },
            {
                "source": "Join_User_Manager",
                "target": "TRANSFORM7"
            },
            {
                "source": "Extract_UserRole",
                "target": "TRANSFORM8"
            },
            {
                "source": "TRANSFORM8",
                "target": "Augment_ParentName"
            },
            {
                "source": "Extract_UserRole",
                "target": "Augment_ParentName"
            },
            {
                "source": "Augment_ParentName",
                "target": "TRANSFORM9"
            },
            {
                "source": "TRANSFORM9",
                "target": "TRANSFORM10"
            },
            {
                "source": "TRANSFORM7",
                "target": "User_with_Roles"
            },
            {
                "source": "TRANSFORM10",
                "target": "User_with_Roles"
            },
            {
                "source": "Append_TaskEvent",
                "target": "Join_ActivityOwner"
            },
            {
                "source": "User_with_Roles",
                "target": "Join_ActivityOwner"
            },
            {
                "source": "Extract_Opportunity_1",
                "target": "TRANSFORM11"
            },
            {
                "source": "TRANSFORM11",
                "target": "TRANSFORM12"
            },
            {
                "source": "TRANSFORM12",
                "target": "TRANSFORM13"
            },
            {
                "source": "TRANSFORM13",
                "target": "Opportunities_No_Products"
            },
            {
                "source": "Opportunities_No_Products",
                "target": "TRANSFORM14"
            },
            {
                "source": "TRANSFORM14",
                "target": "TRANSFORM15"
            },
            {
                "source": "Extract_OpportunityLineItem",
                "target": "Append_LineItems"
            },
            {
                "source": "TRANSFORM15",
                "target": "Append_LineItems"
            },
            {
                "source": "Append_LineItems",
                "target": "TRANSFORM16"
            },
            {
                "source": "TRANSFORM16",
                "target": "Join_OpportunityLineItemPricebookEntry"
            },
            {
                "source": "Extract_PricebookEntry",
                "target": "Join_OpportunityLineItemPricebookEntry"
            },
            {
                "source": "Join_OpportunityLineItemPricebookEntry",
                "target": "Join_OpportunityLineItemPricebookEntryProduct"
            },
            {
                "source": "Extract_Product",
                "target": "Join_OpportunityLineItemPricebookEntryProduct"
            },
            {
                "source": "Extract_OpportunityStage_1",
                "target": "TRANSFORM17"
            },
            {
                "source": "TRANSFORM13",
                "target": "Join_OpportunityOpportunityStage"
            },
            {
                "source": "TRANSFORM17",
                "target": "Join_OpportunityOpportunityStage"
            },
            {
                "source": "Extract_OpportunityHistory_1",
                "target": "TRANSFORM18"
            },
            {
                "source": "TRANSFORM18",
                "target": "TRANSFORM19"
            },
            {
                "source": "TRANSFORM19",
                "target": "TRANSFORM20"
            },
            {
                "source": "TRANSFORM20",
                "target": "TRANSFORM21"
            },
            {
                "source": "TRANSFORM21",
                "target": "Filter_Out_Stage_Updates"
            },
            {
                "source": "Filter_Out_Stage_Updates",
                "target": "TRANSFORM22"
            },
            {
                "source": "TRANSFORM22",
                "target": "TRANSFORM23"
            },
            {
                "source": "TRANSFORM23",
                "target": "Filter_Out_Last_Stage_Updates"
            },
            {
                "source": "Filter_Out_Last_Stage_Updates",
                "target": "TRANSFORM24"
            },
            {
                "source": "Join_OpportunityOpportunityStage",
                "target": "Join_Time_In_Current_Stage_to_Opportunity"
            },
            {
                "source": "TRANSFORM24",
                "target": "Join_Time_In_Current_Stage_to_Opportunity"
            },
            {
                "source": "TRANSFORM21",
                "target": "Join_OpportunityStage"
            },
            {
                "source": "TRANSFORM17",
                "target": "Join_OpportunityStage"
            },
            {
                "source": "Join_OpportunityStage",
                "target": "Join_OpportunityStage_Previous"
            },
            {
                "source": "TRANSFORM17",
                "target": "Join_OpportunityStage_Previous"
            },
            {
                "source": "Join_Time_In_Current_Stage_to_Opportunity",
                "target": "Create_StageName_Multi_Value_Key"
            },
            {
                "source": "Join_OpportunityStage_Previous",
                "target": "Create_StageName_Multi_Value_Key"
            },
            {
                "source": "Create_StageName_Multi_Value_Key",
                "target": "TRANSFORM25"
            },
            {
                "source": "Extract_Account",
                "target": "TRANSFORM26"
            },
            {
                "source": "TRANSFORM26",
                "target": "Join_AccountOwner"
            },
            {
                "source": "User_with_Roles",
                "target": "Join_AccountOwner"
            },
            {
                "source": "TRANSFORM25",
                "target": "Join_OpportunityAccount"
            },
            {
                "source": "Join_AccountOwner",
                "target": "Join_OpportunityAccount"
            },
            {
                "source": "Join_OpportunityAccount",
                "target": "Join_OpportunityOwner"
            },
            {
                "source": "User_with_Roles",
                "target": "Join_OpportunityOwner"
            },
            {
                "source": "Join_OpportunityOwner",
                "target": "TRANSFORM27"
            },
            {
                "source": "Join_OpportunityLineItemPricebookEntryProduct",
                "target": "Join_OpportunityOpportunityLineItemPricebookEntryProduct"
            },
            {
                "source": "TRANSFORM27",
                "target": "Join_OpportunityOpportunityLineItemPricebookEntryProduct"
            },
            {
                "source": "Join_OpportunityOpportunityLineItemPricebookEntryProduct",
                "target": "TRANSFORM28"
            },
            {
                "source": "Join_ActivityOwner",
                "target": "Join_ActivityOwner_Product"
            },
            {
                "source": "TRANSFORM28",
                "target": "Join_ActivityOwner_Product"
            },
            {
                "source": "Join_ActivityOwner_Product",
                "target": "Join_ActivityOwner_Product_Opp"
            },
            {
                "source": "TRANSFORM27",
                "target": "Join_ActivityOwner_Product_Opp"
            },
            {
                "source": "Join_ActivityOwner_Product_Opp",
                "target": "Join_ActivityOwner_Product_Opp_User"
            },
            {
                "source": "TRANSFORM7",
                "target": "Join_ActivityOwner_Product_Opp_User"
            },
            {
                "source": "Join_ActivityOwner_Product_Opp_User",
                "target": "Join_ActivityOwner_Product_Opp_User_Account"
            },
            {
                "source": "Join_AccountOwner",
                "target": "Join_ActivityOwner_Product_Opp_User_Account"
            },
            {
                "source": "Join_ActivityOwner_Product_Opp_User_Account",
                "target": "TRANSFORM29"
            },
            {
                "source": "TRANSFORM29",
                "target": "TRANSFORM30"
            },
            {
                "source": "TRANSFORM30",
                "target": "TRANSFORM31"
            },
            {
                "source": "TRANSFORM31",
                "target": "Filter_Activity"
            },
            {
                "source": "Filter_Activity",
                "target": "Register_Activity"
            },
            {
                "source": "TRANSFORM10",
                "target": "Register_UserRole"
            },
            {
                "source": "Extract_Product",
                "target": "Register_Product"
            },
            {
                "source": "Join_AccountOwner",
                "target": "TRANSFORM32"
            },
            {
                "source": "TRANSFORM32",
                "target": "Filter_Account"
            },
            {
                "source": "TRANSFORM27",
                "target": "Join_OpportunityOwner_Product"
            },
            {
                "source": "TRANSFORM28",
                "target": "Join_OpportunityOwner_Product"
            },
            {
                "source": "Join_OpportunityOwner_Product",
                "target": "TRANSFORM33"
            },
            {
                "source": "TRANSFORM33",
                "target": "Filter_Opportunity"
            },
            {
                "source": "Filter_Account",
                "target": "Join_Account_Opportunity"
            },
            {
                "source": "Filter_Opportunity",
                "target": "Join_Account_Opportunity"
            },
            {
                "source": "Join_Account_Opportunity",
                "target": "TRANSFORM34"
            },
            {
                "source": "TRANSFORM34",
                "target": "TRANSFORM35"
            },
            {
                "source": "TRANSFORM35",
                "target": "Register_Account"
            },
            {
                "source": "User_with_Roles",
                "target": "User_with_Roles_with_Opportunities"
            },
            {
                "source": "TRANSFORM11",
                "target": "User_with_Roles_with_Opportunities"
            },
            {
                "source": "User_with_Roles_with_Opportunities",
                "target": "TRANSFORM36"
            },
            {
                "source": "TRANSFORM36",
                "target": "Filter_UserManager"
            },
            {
                "source": "Filter_UserManager",
                "target": "Register_User"
            },
            {
                "source": "TRANSFORM28",
                "target": "TRANSFORM37"
            },
            {
                "source": "TRANSFORM37",
                "target": "Filter_Opportunity_Products"
            },
            {
                "source": "Filter_Opportunity_Products",
                "target": "Register_OpportunityProducts"
            },
            {
                "source": "TRANSFORM40",
                "target": "Register_Opportunity"
            },
            {
                "source": "Join_OpportunityStage_Previous",
                "target": "Join_ForecastCategory"
            },
            {
                "source": "TRANSFORM17",
                "target": "Join_ForecastCategory"
            },
            {
                "source": "Join_ForecastCategory",
                "target": "Join_ForecastCategory_Previous"
            },
            {
                "source": "TRANSFORM17",
                "target": "Join_ForecastCategory_Previous"
            },
            {
                "source": "Join_ForecastCategory_Previous",
                "target": "Join_Time_In_Current_Stage_to_Pipeline_Trending"
            },
            {
                "source": "TRANSFORM24",
                "target": "Join_Time_In_Current_Stage_to_Pipeline_Trending"
            },
            {
                "source": "Join_Time_In_Current_Stage_to_Pipeline_Trending",
                "target": "Join_OpportunityStage_Previous_with_Opp"
            },
            {
                "source": "TRANSFORM27",
                "target": "Join_OpportunityStage_Previous_with_Opp"
            },
            {
                "source": "Join_OpportunityStage_Previous_with_Opp",
                "target": "Join_OpportunityStage_Previous_with_Opp_Amount"
            },
            {
                "source": "Extract_OpportunityAmount",
                "target": "Join_OpportunityStage_Previous_with_Opp_Amount"
            },
            {
                "source": "Join_OpportunityStage_Previous_with_Opp_Amount",
                "target": "Join_OpportunityStage_Previous_with_Opp_Amount_Product"
            },
            {
                "source": "TRANSFORM28",
                "target": "Join_OpportunityStage_Previous_with_Opp_Amount_Product"
            },
            {
                "source": "Join_OpportunityStage_Previous_with_Opp_Amount_Product",
                "target": "TRANSFORM38"
            },
            {
                "source": "TRANSFORM38",
                "target": "TRANSFORM39"
            },
            {
                "source": "TRANSFORM39",
                "target": "Filter_Pipeline_Trending"
            },
            {
                "source": "Filter_Pipeline_Trending",
                "target": "Register_PipelineTrending"
            },
            {
                "source": "Filter_Opportunity",
                "target": "TRANSFORM40"
            }
        ],
        "hiddenColumns": []
    }
}
